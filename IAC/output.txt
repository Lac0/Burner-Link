/usr/local/lib/node_modules/aws-cdk/lib/index.js:2
${errors.map(e=>e.stack).join("\n")}`)}}static saveManifest(manifest,filePath,schema4,preprocess){let withVersion={...manifest,version:_Manifest.version()};_Manifest.validate(withVersion,schema4);if(preprocess){withVersion=preprocess(withVersion)}fs.writeFileSync(filePath,JSON.stringify(withVersion,void 0,2))}static loadManifest(filePath,schema4,preprocess,options){const contents=fs.readFileSync(filePath,{encoding:"utf-8"});let obj;try{obj=JSON.parse(contents)}catch(e){throw new Error(`${e.message}, while parsing ${JSON.stringify(contents)}`)}if(preprocess){obj=preprocess(obj)}_Manifest.validate(obj,schema4,options);return obj}static patchStackTagsOnRead(manifest){return _Manifest.replaceStackTags(manifest,tags=>tags.map(diskTag=>({key:diskTag.Key,value:diskTag.Value})))}static patchStackTagsOnWrite(manifest){return _Manifest.replaceStackTags(manifest,tags=>tags.map(memTag=>"Key"in memTag?memTag:{Key:memTag.key,Value:memTag.value}))}static replaceStackTags(manifest,fn){return noUndefined({...manifest,artifacts:mapValues(manifest.artifacts,artifact=>{if(artifact.type!=="aws:cloudformation:stack"){return artifact}return noUndefined({...artifact,metadata:mapValues(artifact.metadata,metadataEntries=>metadataEntries.map(metadataEntry=>{if(metadataEntry.type!=="aws:cdk:stack-tags"||!metadataEntry.data){return metadataEntry}return{...metadataEntry,data:fn(metadataEntry.data)}}))})})})}constructor(){}}}});var init_schema3=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/schema.ts"(){"use strict"}});var RequireApproval;var init_common=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/commands/common.ts"(){"use strict";RequireApproval=(RequireApproval3=>{RequireApproval3["NEVER"]="never";RequireApproval3["ANYCHANGE"]="any-change";RequireApproval3["BROADENING"]="broadening";return RequireApproval3})(RequireApproval||{})}});var init_deploy=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/commands/deploy.ts"(){"use strict"}});var init_destroy=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/commands/destroy.ts"(){"use strict"}});var init_commands=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/commands/index.ts"(){"use strict";init_common();init_deploy();init_destroy()}});var init_test_case=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/test-case.ts"(){"use strict"}});var integ_tests_exports={};__export(integ_tests_exports,{RequireApproval:()=>RequireApproval});var init_integ_tests=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/index.ts"(){"use strict";init_schema3();init_commands();init_test_case()}});var require_lib2=__commonJS({"../@aws-cdk/cloud-assembly-schema/lib/index.js"(exports2){"use strict";var __createBinding3=exports2&&exports2.__createBinding||(Object.create?function(o,m,k,k2){if(k2===void 0)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===void 0)k2=k;o[k2]=m[k]});var __exportStar3=exports2&&exports2.__exportStar||function(m,exports3){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports3,p))__createBinding3(exports3,m,p)};Object.defineProperty(exports2,"__esModule",{value:true});__exportStar3((init_cloud_assembly(),__toCommonJS(cloud_assembly_exports)),exports2);__exportStar3((init_assets(),__toCommonJS(assets_exports)),exports2);__exportStar3((init_manifest(),__toCommonJS(manifest_exports)),exports2);__exportStar3((init_integ_tests(),__toCommonJS(integ_tests_exports)),exports2)}});var cxapi_exports={};__export(cxapi_exports,{CLI_ASM_VERSION_ENV:()=>CLI_ASM_VERSION_ENV,CLI_VERSION_ENV:()=>CLI_VERSION_ENV,CONTEXT_ENV:()=>CONTEXT_ENV,CONTEXT_OVERFLOW_LOCATION_ENV:()=>CONTEXT_OVERFLOW_LOCATION_ENV,DEFAULT_ACCOUNT_ENV:()=>DEFAULT_ACCOUNT_ENV,DEFAULT_REGION_ENV:()=>DEFAULT_REGION_ENV,OUTDIR_ENV:()=>OUTDIR_ENV,PROVIDER_ERROR_KEY:()=>PROVIDER_ERROR_KEY,SSMPARAM_NO_INVALIDATE:()=>SSMPARAM_NO_INVALIDATE});var OUTDIR_ENV,CONTEXT_ENV,CONTEXT_OVERFLOW_LOCATION_ENV,DEFAULT_ACCOUNT_ENV,DEFAULT_REGION_ENV,CLI_ASM_VERSION_ENV,CLI_VERSION_ENV,PROVIDER_ERROR_KEY,SSMPARAM_NO_INVALIDATE;var init_cxapi=__esm({"../@aws-cdk/cx-api/lib/cxapi.ts"(){"use strict";OUTDIR_ENV="CDK_OUTDIR";CONTEXT_ENV="CDK_CONTEXT_JSON";CONTEXT_OVERFLOW_LOCATION_ENV="CONTEXT_OVERFLOW_LOCATION_ENV";DEFAULT_ACCOUNT_ENV="CDK_DEFAULT_ACCOUNT";DEFAULT_REGION_ENV="CDK_DEFAULT_REGION";CLI_ASM_VERSION_ENV="CDK_CLI_ASM_VERSION";CLI_VERSION_ENV="CDK_CLI_VERSION";PROVIDER_ERROR_KEY="$providerError";SSMPARAM_NO_INVALIDATE="[cdk:skip]"}});var vpc_exports={};__export(vpc_exports,{VpcSubnetGroupType:()=>VpcSubnetGroupType});var VpcSubnetGroupType;var init_vpc=__esm({"../@aws-cdk/cx-api/lib/context/vpc.ts"(){"use strict";VpcSubnetGroupType=(VpcSubnetGroupType3=>{VpcSubnetGroupType3["PUBLIC"]="Public";VpcSubnetGroupType3["PRIVATE"]="Private";VpcSubnetGroupType3["ISOLATED"]="Isolated";return VpcSubnetGroupType3})(VpcSubnetGroupType||{})}});var ami_exports={};var init_ami=__esm({"../@aws-cdk/cx-api/lib/context/ami.ts"(){"use strict"}});var load_balancer_exports={};__export(load_balancer_exports,{LoadBalancerIpAddressType:()=>LoadBalancerIpAddressType});var LoadBalancerIpAddressType;var init_load_balancer=__esm({"../@aws-cdk/cx-api/lib/context/load-balancer.ts"(){"use strict";LoadBalancerIpAddressType=(LoadBalancerIpAddressType3=>{LoadBalancerIpAddressType3["IPV4"]="ipv4";LoadBalancerIpAddressType3["DUAL_STACK"]="dualstack";return LoadBalancerIpAddressType3})(LoadBalancerIpAddressType||{})}});var availability_zones_exports={};__export(availability_zones_exports,{AVAILABILITY_ZONE_FALLBACK_CONTEXT_KEY:()=>AVAILABILITY_ZONE_FALLBACK_CONTEXT_KEY});var AVAILABILITY_ZONE_FALLBACK_CONTEXT_KEY;var init_availability_zones=__esm({"../@aws-cdk/cx-api/lib/context/availability-zones.ts"(){"use strict";AVAILABILITY_ZONE_FALLBACK_CONTEXT_KEY="aws:cdk:availability-zones:fallback"}});var endpoint_service_availability_zones_exports={};__export(endpoint_service_availability_zones_exports,{ENDPOINT_SERVICE_AVAILABILITY_ZONE_PROVIDER:()=>ENDPOINT_SERVICE_AVAILABILITY_ZONE_PROVIDER});var ENDPOINT_SERVICE_AVAILABILITY_ZONE_PROVIDER;var init_endpoint_service_availability_zones=__esm({"../@aws-cdk/cx-api/lib/context/endpoint-service-availability-zones.ts"(){"use strict";ENDPOINT_SERVICE_AVAILABILITY_ZONE_PROVIDER="endpoint-service-availability-zones"}});var security_group_exports={};var init_security_group=__esm({"../@aws-cdk/cx-api/lib/context/security-group.ts"(){"use strict"}});var key_exports={};var init_key=__esm({"../@aws-cdk/cx-api/lib/context/key.ts"(){"use strict"}});var metadata_exports={};__export(metadata_exports,{PATH_METADATA_KEY:()=>PATH_METADATA_KEY,SynthesisMessageLevel:()=>SynthesisMessageLevel});var PATH_METADATA_KEY,SynthesisMessageLevel;var init_metadata=__esm({"../@aws-cdk/cx-api/lib/metadata.ts"(){"use strict";PATH_METADATA_KEY="aws:cdk:path";SynthesisMessageLevel=(SynthesisMessageLevel3=>{SynthesisMessageLevel3["INFO"]="info";SynthesisMessageLevel3["WARNING"]="warning";SynthesisMessageLevel3["ERROR"]="error";return SynthesisMessageLevel3})(SynthesisMessageLevel||{})}});var cloud_artifact_exports={};__export(cloud_artifact_exports,{CloudArtifact:()=>CloudArtifact});var cxschema,CloudArtifact;var init_cloud_artifact=__esm({"../@aws-cdk/cx-api/lib/cloud-artifact.ts"(){"use strict";init_metadata();cxschema=__toESM(require_lib2());CloudArtifact=class{constructor(assembly,id,manifest){this.assembly=assembly;this.id=id;this.manifest=manifest;this.messages=this.renderMessages();this._dependencyIDs=manifest.dependencies||[]}static fromManifest(assembly,id,artifact){void 0,void 0,void 0;throw new Error("Implementation not overridden yet")}get dependencies(){if(this._deps){return this._deps}this._deps=this._dependencyIDs.map(id=>{const dep=this.assembly.tryGetArtifact(id);if(!dep){throw new Error(`Artifact ${this.id} depends on non-existing artifact ${id}`)}return dep});return this._deps}findMetadataByType(type){const result=new Array;for(const path30 of Object.keys(this.manifest.metadata||{})){for(const entry of(this.manifest.metadata||{})[path30]){if(entry.type===type){result.push({path:path30,...entry})}}}return result}renderMessages(){const messages=new Array;for(const[id,metadata]of Object.entries(this.manifest.metadata||{})){for(const entry of metadata){let level;switch(entry.type){case cxschema.ArtifactMetadataEntryType.WARN:level="warning";break;case cxschema.ArtifactMetadataEntryType.ERROR:level="error";break;case cxschema.ArtifactMetadataEntryType.INFO:level="info";break;default:continue}messages.push({level,entry,id})}}return messages}get hierarchicalId(){return this.manifest.displayName??this.id}}}});var asset_manifest_artifact_exports={};__export(asset_manifest_artifact_exports,{AssetManifestArtifact:()=>AssetManifestArtifact});var fs2,path,ASSET_MANIFEST_ARTIFACT_SYM,AssetManifestArtifact;var init_asset_manifest_artifact=__esm({"../@aws-cdk/cx-api/lib/artifacts/asset-manifest-artifact.ts"(){"use strict";fs2=__toESM(require("fs"));path=__toESM(require("path"));init_cloud_artifact();ASSET_MANIFEST_ARTIFACT_SYM=Symbol.for("@aws-cdk/cx-api.AssetManifestArtifact");AssetManifestArtifact=class extends CloudArtifact{constructor(assembly,name,artifact){super(assembly,name,artifact);const properties=this.manifest.properties||{};if(!properties.file){throw new Error('Invalid AssetManifestArtifact. Missing "file" property')}this.file=path.resolve(this.assembly.directory,properties.file);this.requiresBootstrapStackVersion=properties.requiresBootstrapStackVersion;this.bootstrapStackVersionSsmParameter=properties.bootstrapStackVersionSsmParameter}static isAssetManifestArtifact(art){return art&&typeof art==="object"&&art[ASSET_MANIFEST_ARTIFACT_SYM]}get contents(){if(this._contents!==void 0){return this._contents}const contents=this._contents=JSON.parse(fs2.readFileSync(this.file,"utf-8"));return contents}};Object.defineProperty(AssetManifestArtifact.prototype,ASSET_MANIFEST_ARTIFACT_SYM,{value:true,enumerable:false,writable:false})}});var environment_exports={};__export(environment_exports,{EnvironmentUtils:()=>EnvironmentUtils,UNKNOWN_ACCOUNT:()=>UNKNOWN_ACCOUNT,UNKNOWN_REGION:()=>UNKNOWN_REGION});var AWS_ENV_REGEX,UNKNOWN_ACCOUNT,UNKNOWN_REGION,EnvironmentUtils;var init_environment=__esm({"../@aws-cdk/cx-api/lib/environment.ts"(){"use strict";AWS_ENV_REGEX=/aws\:\/\/([a-z0-9A-Z\-\@\.\_]+)\/([a-z\-0-9]+)/;UNKNOWN_ACCOUNT="unknown-account";UNKNOWN_REGION="unknown-region";EnvironmentUtils=class{static parse(environment){const env2=AWS_ENV_REGEX.exec(environment);if(!env2){throw new Error(`Unable to parse environment specification "${environment}". Expected format: aws://account/region`)}const[,account,region]=env2;if(!account||!region){throw new Error(`Invalid environment specification: ${environment}`)}return{account,region,name:environment}}static make(account,region){return{account,region,name:this.format(account,region)}}static format(account,region){return`aws://${account}/${region}`}}}});var cloudformation_artifact_exports={};__export(cloudformation_artifact_exports,{CloudFormationStackArtifact:()=>CloudFormationStackArtifact});var fs3,path2,cxschema2,CLOUDFORMATION_STACK_ARTIFACT_SYM,CloudFormationStackArtifact;var init_cloudformation_artifact=__esm({"../@aws-cdk/cx-api/lib/artifacts/cloudformation-artifact.ts"(){"use strict";fs3=__toESM(require("fs"));path2=__toESM(require("path"));cxschema2=__toESM(require_lib2());init_cloud_artifact();init_environment();CLOUDFORMATION_STACK_ARTIFACT_SYM=Symbol.for("@aws-cdk/cx-api.CloudFormationStackArtifact");CloudFormationStackArtifact=class extends CloudArtifact{constructor(assembly,artifactId,artifact){super(assembly,artifactId,artifact);const properties=this.manifest.properties||{};if(!properties.templateFile){throw new Error('Invalid CloudFormation stack artifact. Missing "templateFile" property in cloud assembly manifest')}if(!artifact.environment){throw new Error("Invalid CloudFormation stack artifact. Missing environment")}this.environment=EnvironmentUtils.parse(artifact.environment);this.templateFile=properties.templateFile;this.parameters=properties.parameters??{};this.tags=properties.tags??this.tagsFromMetadata();this.assumeRoleArn=properties.assumeRoleArn;this.assumeRoleExternalId=properties.assumeRoleExternalId;this.cloudFormationExecutionRoleArn=properties.cloudFormationExecutionRoleArn;this.stackTemplateAssetObjectUrl=properties.stackTemplateAssetObjectUrl;this.requiresBootstrapStackVersion=properties.requiresBootstrapStackVersion;this.bootstrapStackVersionSsmParameter=properties.bootstrapStackVersionSsmParameter;this.terminationProtection=properties.terminationProtection;this.validateOnSynth=properties.validateOnSynth;this.lookupRole=properties.lookupRole;this.stackName=properties.stackName||artifactId;this.assets=this.findMetadataByType(cxschema2.ArtifactMetadataEntryType.ASSET).map(e=>e.data);this.displayName=this.stackName===artifactId?this.hierarchicalId:`${this.hierarchicalId} (${this.stackName})`;this.name=this.stackName;this.originalName=this.stackName}static isCloudFormationStackArtifact(art){return art&&typeof art==="object"&&art[CLOUDFORMATION_STACK_ARTIFACT_SYM]}get templateFullPath(){return path2.join(this.assembly.directory,this.templateFile)}get template(){if(this._template===void 0){this._template=JSON.parse(fs3.readFileSync(this.templateFullPath,"utf-8"))}return this._template}tagsFromMetadata(){const ret={};for(const metadataEntry of this.findMetadataByType(cxschema2.ArtifactMetadataEntryType.STACK_TAGS)){for(const tag of metadataEntry.data??[]){ret[tag.key]=tag.value}}return ret}};Object.defineProperty(CloudFormationStackArtifact.prototype,CLOUDFORMATION_STACK_ARTIFACT_SYM,{value:true,enumerable:false,writable:false})}});var nested_cloud_assembly_artifact_exports={};__export(nested_cloud_assembly_artifact_exports,{NestedCloudAssemblyArtifact:()=>NestedCloudAssemblyArtifact});var path3,NESTED_CLOUD_ASSEMBLY_SYM,NestedCloudAssemblyArtifact;var init_nested_cloud_assembly_artifact=__esm({"../@aws-cdk/cx-api/lib/artifacts/nested-cloud-assembly-artifact.ts"(){"use strict";path3=__toESM(require("path"));init_cloud_artifact();NESTED_CLOUD_ASSEMBLY_SYM=Symbol.for("@aws-cdk/cx-api.NestedCloudAssemblyArtifact");NestedCloudAssemblyArtifact=class extends CloudArtifact{constructor(assembly,name,artifact){super(assembly,name,artifact);const properties=this.manifest.properties||{};this.directoryName=properties.directoryName;this.displayName=properties.displayName??name}static isNestedCloudAssemblyArtifact(art){return art&&typeof art==="object"&&art[NESTED_CLOUD_ASSEMBLY_SYM]}get fullPath(){return path3.join(this.assembly.directory,this.directoryName)}};Object.defineProperty(NestedCloudAssemblyArtifact.prototype,NESTED_CLOUD_ASSEMBLY_SYM,{value:true,enumerable:false,writable:false})}});var tree_cloud_artifact_exports={};__export(tree_cloud_artifact_exports,{TreeCloudArtifact:()=>TreeCloudArtifact});var TREE_CLOUD_ARTIFACT_SYM,TreeCloudArtifact;var init_tree_cloud_artifact=__esm({"../@aws-cdk/cx-api/lib/artifacts/tree-cloud-artifact.ts"(){"use strict";init_cloud_artifact();TREE_CLOUD_ARTIFACT_SYM=Symbol.for("@aws-cdk/cx-api.TreeCloudArtifact");TreeCloudArtifact=class extends CloudArtifact{constructor(assembly,name,artifact){super(assembly,name,artifact);const properties=this.manifest.properties||{};if(!properties.file){throw new Error('Invalid TreeCloudArtifact. Missing "file" property')}this.file=properties.file}static isTreeCloudArtifact(art){return art&&typeof art==="object"&&art[TREE_CLOUD_ARTIFACT_SYM]}};Object.defineProperty(TreeCloudArtifact.prototype,TREE_CLOUD_ARTIFACT_SYM,{value:true,enumerable:false,writable:false})}});var cloud_artifact_aug_exports={};var cxschema3;var init_cloud_artifact_aug=__esm({"../@aws-cdk/cx-api/lib/cloud-artifact-aug.ts"(){"use strict";init_asset_manifest_artifact();init_cloudformation_artifact();init_nested_cloud_assembly_artifact();init_tree_cloud_artifact();init_cloud_artifact();cxschema3=__toESM(require_lib2());CloudArtifact.fromManifest=function fromManifest(assembly,id,artifact){switch(artifact.type){case cxschema3.ArtifactType.AWS_CLOUDFORMATION_STACK:return new CloudFormationStackArtifact(assembly,id,artifact);case cxschema3.ArtifactType.CDK_TREE:return new TreeCloudArtifact(assembly,id,artifact);case cxschema3.ArtifactType.ASSET_MANIFEST:return new AssetManifestArtifact(assembly,id,artifact);case cxschema3.ArtifactType.NESTED_CLOUD_ASSEMBLY:return new NestedCloudAssemblyArtifact(assembly,id,artifact);default:return void 0}}}});function topologicalSort(xs,keyFn,depFn){const remaining=new Map;for(const element of xs){const key=keyFn(element);remaining.set(key,{key,element,dependencies:depFn(element)})}const ret=new Array;while(remaining.size>0){const selectable=Array.from(remaining.values()).filter(e=>e.dependencies.every(d=>!remaining.has(d)));selectable.sort((a,b)=>a.key<b.key?-1:b.key<a.key?1:0);for(const selected of selectable){ret.push(selected.element);remaining.delete(selected.key)}if(selectable.length===0){throw new Error(`Could not determine ordering between: ${Array.from(remaining.keys()).join(", ")}`)}}return ret}var init_toposort=__esm({"../@aws-cdk/cx-api/lib/toposort.ts"(){"use strict"}});var cloud_assembly_exports2={};__export(cloud_assembly_exports2,{CloudAssembly:()=>CloudAssembly,CloudAssemblyBuilder:()=>CloudAssemblyBuilder});function filterUndefined(obj){if(Array.isArray(obj)){return obj.filter(x=>x!==void 0).map(x=>filterUndefined(x))}if(typeof obj==="object"){const ret={};for(const[key,value]of Object.entries(obj)){if(value===void 0){continue}ret[key]=filterUndefined(value)}return ret}return obj}function ignore(_x){return}function determineOutputDirectory(outdir){return outdir??fs4.mkdtempSync(path4.join(fs4.realpathSync(os.tmpdir()),"cdk.out"))}function ensureDirSync(dir){if(fs4.existsSync(dir)){if(!fs4.statSync(dir).isDirectory()){throw new Error(`${dir} must be a directory`)}}else{fs4.mkdirSync(dir,{recursive:true})}}var fs4,os,path4,cxschema4,MANIFEST_FILE,CloudAssembly,CloudAssemblyBuilder;var init_cloud_assembly2=__esm({"../@aws-cdk/cx-api/lib/cloud-assembly.ts"(){"use strict";fs4=__toESM(require("fs"));os=__toESM(require("os"));path4=__toESM(require("path"));init_cloudformation_artifact();init_nested_cloud_assembly_artifact();init_tree_cloud_artifact();init_cloud_artifact();init_toposort();cxschema4=__toESM(require_lib2());MANIFEST_FILE="manifest.json";CloudAssembly=class{constructor(directory,loadOptions){this.directory=directory;this.manifest=cxschema4.Manifest.loadAssemblyManifest(path4.join(directory,MANIFEST_FILE),loadOptions);this.version=this.manifest.version;this.artifacts=this.renderArtifacts((loadOptions==null?void 0:loadOptions.topoSort)??true);this.runtime=this.manifest.runtime||{libraries:{}};this.validateDeps()}tryGetArtifact(id){return this.artifacts.find(a=>a.id===id)}getStackByName(stackName){const artifacts=this.artifacts.filter(a=>a instanceof CloudFormationStackArtifact&&a.stackName===stackName);if(!artifacts||artifacts.length===0){throw new Error(`Unable to find stack with stack name "${stackName}"`)}if(artifacts.length>1){throw new Error(`There are multiple stacks with the stack name "${stackName}" (${artifacts.map(a=>a.id).join(",")}). Use "getStackArtifact(id)" instead`)}return artifacts[0]}getStack(stackName){return this.getStackByName(stackName)}getStackArtifact(artifactId){const artifact=this.tryGetArtifactRecursively(artifactId);if(!artifact){throw new Error(`Unable to find artifact with id "${artifactId}"`)}if(!(artifact instanceof CloudFormationStackArtifact)){throw new Error(`Artifact ${artifactId} is not a CloudFormation stack`)}return artifact}tryGetArtifactRecursively(artifactId){return this.stacksRecursively.find(a=>a.id===artifactId)}get stacksRecursively(){function search(stackArtifacts,assemblies){if(assemblies.length===0){return stackArtifacts}const[head,...tail]=assemblies;const nestedAssemblies=head.nestedAssemblies.map(asm=>asm.nestedAssembly);return search(stackArtifacts.concat(head.stacks),tail.concat(nestedAssemblies))};return search([],[this])}getNestedAssemblyArtifact(artifactId){const artifact=this.tryGetArtifact(artifactId);if(!artifact){throw new Error(`Unable to find artifact with id "${artifactId}"`)}if(!(artifact instanceof NestedCloudAssemblyArtifact)){throw new Error(`Found artifact '${artifactId}' but it's not a nested cloud assembly`)}return artifact}getNestedAssembly(artifactId){return this.getNestedAssemblyArtifact(artifactId).nestedAssembly}tree(){const trees=this.artifacts.filter(a=>a.manifest.type===cxschema4.ArtifactType.CDK_TREE);if(trees.length===0){return void 0}else if(trees.length>1){throw new Error(`Multiple artifacts of type ${cxschema4.ArtifactType.CDK_TREE} found in manifest`)}const tree=trees[0];if(!(tree instanceof TreeCloudArtifact)){throw new Error('"Tree" artifact is not of expected type')}return tree}get stacks(){return this.artifacts.filter(isCloudFormationStackArtifact);function isCloudFormationStackArtifact(x){return x instanceof CloudFormationStackArtifact}}get nestedAssemblies(){return this.artifacts.filter(isNestedCloudAssemblyArtifact);function isNestedCloudAssemblyArtifact(x){return x instanceof NestedCloudAssemblyArtifact}}validateDeps(){for(const artifact of this.artifacts){ignore(artifact.dependencies)}}renderArtifacts(topoSort){const result=new Array;for(const[name,artifact]of Object.entries(this.manifest.artifacts||{})){const cloudartifact=CloudArtifact.fromManifest(this,name,artifact);if(cloudartifact){result.push(cloudartifact)}}return topoSort?topologicalSort(result,x=>x.id,x=>x._dependencyIDs):result}};CloudAssemblyBuilder=class _CloudAssemblyBuilder{constructor(outdir,props={}){this.artifacts={};this.missing=new Array;this.outdir=determineOutputDirectory(outdir);this.assetOutdir=props.assetOutdir??this.outdir;this.parentBuilder=props.parentBuilder;ensureDirSync(this.outdir)}addArtifact(id,manifest){this.artifacts[id]=filterUndefined(manifest)}addMissing(missing){var _a;if(this.missing.every(m=>m.key!==missing.key)){this.missing.push(missing)}(_a=this.parentBuilder)==null?void 0:_a.addMissing(missing)}buildAssembly(options={}){let manifest={version:cxschema4.Manifest.version(),artifacts:this.artifacts,runtime:options.runtimeInfo,missing:this.missing.length>0?this.missing:void 0};manifest=filterUndefined(manifest);const manifestFilePath=path4.join(this.outdir,MANIFEST_FILE);cxschema4.Manifest.saveAssemblyManifest(manifest,manifestFilePath);fs4.writeFileSync(path4.join(this.outdir,"cdk.out"),JSON.stringify({version:manifest.version}));return new CloudAssembly(this.outdir)}createNestedAssembly(artifactId,displayName){const directoryName=artifactId;const innerAsmDir=path4.join(this.outdir,directoryName);this.addArtifact(artifactId,{type:cxschema4.ArtifactType.NESTED_CLOUD_ASSEMBLY,properties:{directoryName,displayName}});return new _CloudAssemblyBuilder(innerAsmDir,{assetOutdir:this.assetOutdir,parentBuilder:this})}delete(){fs4.rmSync(this.outdir,{recursive:true,force:true})}}}});var nested_cloud_assembly_artifact_aug_exports={};var cacheSym;var init_nested_cloud_assembly_artifact_aug=__esm({"../@aws-cdk/cx-api/lib/artifacts/nested-cloud-assembly-artifact-aug.ts"(){"use strict";init_nested_cloud_assembly_artifact();init_cloud_assembly2();cacheSym=Symbol();Object.defineProperty(NestedCloudAssemblyArtifact.prototype,"nestedAssembly",{get(){if(!this[cacheSym]){this[cacheSym]=new CloudAssembly(this.fullPath)}return this[cacheSym]}})}});var assets_exports2={};__export(assets_exports2,{ASSET_PREFIX_SEPARATOR:()=>ASSET_PREFIX_SEPARATOR,ASSET_RESOURCE_METADATA_DOCKERFILE_PATH_KEY:()=>ASSET_RESOURCE_METADATA_DOCKERFILE_PATH_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_ARGS_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_BUILD_ARGS_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_SECRETS_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_BUILD_SECRETS_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_SSH_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_BUILD_SSH_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_TARGET_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_BUILD_TARGET_KEY,ASSET_RESOURCE_METADATA_DOCKER_CACHE_FROM_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_CACHE_FROM_KEY,ASSET_RESOURCE_METADATA_DOCKER_CACHE_TO_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_CACHE_TO_KEY,ASSET_RESOURCE_METADATA_DOCKER_OUTPUTS_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_OUTPUTS_KEY,ASSET_RESOURCE_METADATA_ENABLED_CONTEXT:()=>ASSET_RESOURCE_METADATA_ENABLED_CONTEXT,ASSET_RESOURCE_METADATA_IS_BUNDLED_KEY:()=>ASSET_RESOURCE_METADATA_IS_BUNDLED_KEY,ASSET_RESOURCE_METADATA_PATH_KEY:()=>ASSET_RESOURCE_METADATA_PATH_KEY,ASSET_RESOURCE_METADATA_PROPERTY_KEY:()=>ASSET_RESOURCE_METADATA_PROPERTY_KEY});var ASSET_RESOURCE_METADATA_ENABLED_CONTEXT,ASSET_RESOURCE_METADATA_PATH_KEY,ASSET_RESOURCE_METADATA_DOCKERFILE_PATH_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_ARGS_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_SECRETS_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_SSH_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_TARGET_KEY,ASSET_RESOURCE_METADATA_PROPERTY_KEY,ASSET_RESOURCE_METADATA_IS_BUNDLED_KEY,ASSET_RESOURCE_METADATA_DOCKER_OUTPUTS_KEY,ASSET_RESOURCE_METADATA_DOCKER_CACHE_FROM_KEY,ASSET_RESOURCE_METADATA_DOCKER_CACHE_TO_KEY,ASSET_PREFIX_SEPARATOR;var init_assets2=__esm({"../@aws-cdk/cx-api/lib/assets.ts"(){"use strict";ASSET_RESOURCE_METADATA_ENABLED_CONTEXT="aws:cdk:enable-asset-metadata";ASSET_RESOURCE_METADATA_PATH_KEY="aws:asset:path";ASSET_RESOURCE_METADATA_DOCKERFILE_PATH_KEY="aws:asset:dockerfile-path";ASSET_RESOURCE_METADATA_DOCKER_BUILD_ARGS_KEY="aws:asset:docker-build-args";ASSET_RESOURCE_METADATA_DOCKER_BUILD_SECRETS_KEY="aws:asset:docker-build-secrets";ASSET_RESOURCE_METADATA_DOCKER_BUILD_SSH_KEY="aws:asset:docker-build-ssh";ASSET_RESOURCE_METADATA_DOCKER_BUILD_TARGET_KEY="aws:asset:docker-build-target";ASSET_RESOURCE_METADATA_PROPERTY_KEY="aws:asset:property";ASSET_RESOURCE_METADATA_IS_BUNDLED_KEY="aws:asset:is-bundled";ASSET_RESOURCE_METADATA_DOCKER_OUTPUTS_KEY="aws:asset:docker-outputs";ASSET_RESOURCE_METADATA_DOCKER_CACHE_FROM_KEY="aws:asset:docker-cache-from";ASSET_RESOURCE_METADATA_DOCKER_CACHE_TO_KEY="aws:asset:docker-cache-to";ASSET_PREFIX_SEPARATOR="||"}});var init_flag_modeling=__esm({"../@aws-cdk/cx-api/lib/private/flag-modeling.ts"(){"use strict"}});var features_exports={};__export(features_exports,{APIGATEWAY_AUTHORIZER_CHANGE_DEPLOYMENT_LOGICAL_ID:()=>APIGATEWAY_AUTHORIZER_CHANGE_DEPLOYMENT_LOGICAL_ID,APIGATEWAY_DISABLE_CLOUDWATCH_ROLE:()=>APIGATEWAY_DISABLE_CLOUDWATCH_ROLE,APIGATEWAY_REQUEST_VALIDATOR_UNIQUE_ID:()=>APIGATEWAY_REQUEST_VALIDATOR_UNIQUE_ID,APIGATEWAY_USAGEPLANKEY_ORDERINSENSITIVE_ID:()=>APIGATEWAY_USAGEPLANKEY_ORDERINSENSITIVE_ID,AUTOSCALING_GENERATE_LAUNCH_TEMPLATE:()=>AUTOSCALING_GENERATE_LAUNCH_TEMPLATE,AWS_CUSTOM_RESOURCE_LATEST_SDK_DEFAULT:()=>AWS_CUSTOM_RESOURCE_LATEST_SDK_DEFAULT,CHECK_SECRET_USAGE:()=>CHECK_SECRET_USAGE,CLOUDFRONT_DEFAULT_SECURITY_POLICY_TLS_V1_2_2021:()=>CLOUDFRONT_DEFAULT_SECURITY_POLICY_TLS_V1_2_2021,CODEDEPLOY_REMOVE_ALARMS_FROM_DEPLOYMENT_GROUP:()=>CODEDEPLOY_REMOVE_ALARMS_FROM_DEPLOYMENT_GROUP,CODEPIPELINE_CROSS_ACCOUNT_KEY_ALIAS_STACK_SAFE_RESOURCE_NAME:()=>CODEPIPELINE_CROSS_ACCOUNT_KEY_ALIAS_STACK_SAFE_RESOURCE_NAME,CURRENT_VERSION_EXPIRED_FLAGS:()=>CURRENT_VERSION_EXPIRED_FLAGS,CURRENT_VERSION_FLAG_DEFAULTS:()=>CURRENT_VERSION_FLAG_DEFAULTS,DATABASE_PROXY_UNIQUE_RESOURCE_NAME:()=>DATABASE_PROXY_UNIQUE_RESOURCE_NAME,DOCKER_IGNORE_SUPPORT:()=>DOCKER_IGNORE_SUPPORT,EC2_LAUNCH_TEMPLATE_DEFAULT_USER_DATA:()=>EC2_LAUNCH_TEMPLATE_DEFAULT_USER_DATA,EC2_RESTRICT_DEFAULT_SECURITY_GROUP:()=>EC2_RESTRICT_DEFAULT_SECURITY_GROUP,EC2_UNIQUE_IMDSV2_LAUNCH_TEMPLATE_NAME:()=>EC2_UNIQUE_IMDSV2_LAUNCH_TEMPLATE_NAME,ECS_ARN_FORMAT_INCLUDES_CLUSTER_NAME:()=>ECS_ARN_FORMAT_INCLUDES_CLUSTER_NAME,ECS_DISABLE_EXPLICIT_DEPLOYMENT_CONTROLLER_FOR_CIRCUIT_BREAKER:()=>ECS_DISABLE_EXPLICIT_DEPLOYMENT_CONTROLLER_FOR_CIRCUIT_BREAKER,ECS_REMOVE_DEFAULT_DESIRED_COUNT:()=>ECS_REMOVE_DEFAULT_DESIRED_COUNT,ECS_SERVICE_EXTENSIONS_ENABLE_DEFAULT_LOG_DRIVER:()=>ECS_SERVICE_EXTENSIONS_ENABLE_DEFAULT_LOG_DRIVER,EFS_DEFAULT_ENCRYPTION_AT_REST:()=>EFS_DEFAULT_ENCRYPTION_AT_REST,EFS_DENY_ANONYMOUS_ACCESS:()=>EFS_DENY_ANONYMOUS_ACCESS,EFS_MOUNTTARGET_ORDERINSENSITIVE_LOGICAL_ID:()=>EFS_MOUNTTARGET_ORDERINSENSITIVE_LOGICAL_ID,ENABLE_DIFF_NO_FAIL:()=>ENABLE_DIFF_NO_FAIL,ENABLE_DIFF_NO_FAIL_CONTEXT:()=>ENABLE_DIFF_NO_FAIL_CONTEXT,ENABLE_EMR_SERVICE_POLICY_V2:()=>ENABLE_EMR_SERVICE_POLICY_V2,ENABLE_OPENSEARCH_MULTIAZ_WITH_STANDBY:()=>ENABLE_OPENSEARCH_MULTIAZ_WITH_STANDBY,ENABLE_PARTITION_LITERALS:()=>ENABLE_PARTITION_LITERALS,ENABLE_STACK_NAME_DUPLICATES_CONTEXT:()=>ENABLE_STACK_NAME_DUPLICATES_CONTEXT,EVENTS_TARGET_QUEUE_SAME_ACCOUNT:()=>EVENTS_TARGET_QUEUE_SAME_ACCOUNT,FLAGS:()=>FLAGS,FUTURE_FLAGS:()=>FUTURE_FLAGS,FUTURE_FLAGS_EXPIRED:()=>FUTURE_FLAGS_EXPIRED,IAM_IMPORTED_ROLE_STACK_SAFE_DEFAULT_POLICY_NAME:()=>IAM_IMPORTED_ROLE_STACK_SAFE_DEFAULT_POLICY_NAME,IAM_MINIMIZE_POLICIES:()=>IAM_MINIMIZE_POLICIES,IAM_STANDARDIZED_SERVICE_PRINCIPALS:()=>IAM_STANDARDIZED_SERVICE_PRINCIPALS,INCLUDE_PREFIX_IN_UNIQUE_NAME_GENERATION:()=>INCLUDE_PREFIX_IN_UNIQUE_NAME_GENERATION,KMS_ALIAS_NAME_REF:()=>KMS_ALIAS_NAME_REF,KMS_DEFAULT_KEY_POLICIES:()=>KMS_DEFAULT_KEY_POLICIES,LAMBDA_NODEJS_USE_LATEST_RUNTIME:()=>LAMBDA_NODEJS_USE_LATEST_RUNTIME,LAMBDA_RECOGNIZE_LAYER_VERSION:()=>LAMBDA_RECOGNIZE_LAYER_VERSION,LAMBDA_RECOGNIZE_VERSION_PROPS:()=>LAMBDA_RECOGNIZE_VERSION_PROPS,NEW_PROJECT_CONTEXT:()=>NEW_PROJECT_CONTEXT,NEW_PROJECT_DEFAULT_CONTEXT:()=>NEW_PROJECT_DEFAULT_CONTEXT,NEW_STYLE_STACK_SYNTHESIS_CONTEXT:()=>NEW_STYLE_STACK_SYNTHESIS_CONTEXT,RDS_LOWERCASE_DB_IDENTIFIER:()=>RDS_LOWERCASE_DB_IDENTIFIER,REDSHIFT_COLUMN_ID:()=>REDSHIFT_COLUMN_ID,ROUTE53_PATTERNS_USE_CERTIFICATE:()=>ROUTE53_PATTERNS_USE_CERTIFICATE,S3_CREATE_DEFAULT_LOGGING_POLICY:()=>S3_CREATE_DEFAULT_LOGGING_POLICY,S3_GRANT_WRITE_WITHOUT_ACL:()=>S3_GRANT_WRITE_WITHOUT_ACL,S3_SERVER_ACCESS_LOGS_USE_BUCKET_POLICY:()=>S3_SERVER_ACCESS_LOGS_USE_BUCKET_POLICY,SECRETS_MANAGER_PARSE_OWNED_SECRET_NAME:()=>SECRETS_MANAGER_PARSE_OWNED_SECRET_NAME,SECRETS_MANAGER_TARGET_ATTACHMENT_RESOURCE_POLICY:()=>SECRETS_MANAGER_TARGET_ATTACHMENT_RESOURCE_POLICY,SNS_SUBSCRIPTIONS_SQS_DECRYPTION_POLICY:()=>SNS_SUBSCRIPTIONS_SQS_DECRYPTION_POLICY,STACK_RELATIVE_EXPORTS_CONTEXT:()=>STACK_RELATIVE_EXPORTS_CONTEXT,TARGET_PARTITIONS:()=>TARGET_PARTITIONS,VALIDATE_SNAPSHOT_REMOVAL_POLICY:()=>VALIDATE_SNAPSHOT_REMOVAL_POLICY,futureFlagDefault:()=>futureFlagDefault});function futureFlagDefault(flag){const value=CURRENT_VERSION_FLAG_DEFAULTS[flag]??false;if(typeof value!=="boolean"){throw new Error(`futureFlagDefault: default type of flag '${flag}' should be boolean, got '${typeof value}'`)}return value}var ENABLE_STACK_NAME_DUPLICATES_CONTEXT,ENABLE_DIFF_NO_FAIL_CONTEXT,ENABLE_DIFF_NO_FAIL,NEW_STYLE_STACK_SYNTHESIS_CONTEXT,STACK_RELATIVE_EXPORTS_CONTEXT,DOCKER_IGNORE_SUPPORT,SECRETS_MANAGER_PARSE_OWNED_SECRET_NAME,KMS_DEFAULT_KEY_POLICIES,S3_GRANT_WRITE_WITHOUT_ACL,ECS_REMOVE_DEFAULT_DESIRED_COUNT,RDS_LOWERCASE_DB_IDENTIFIER,APIGATEWAY_USAGEPLANKEY_ORDERINSENSITIVE_ID,EFS_DEFAULT_ENCRYPTION_AT_REST,LAMBDA_RECOGNIZE_VERSION_PROPS,LAMBDA_RECOGNIZE_LAYER_VERSION,CLOUDFRONT_DEFAULT_SECURITY_POLICY_TLS_V1_2_2021,CHECK_SECRET_USAGE,TARGET_PARTITIONS,ECS_SERVICE_EXTENSIONS_ENABLE_DEFAULT_LOG_DRIVER,EC2_UNIQUE_IMDSV2_LAUNCH_TEMPLATE_NAME,ECS_ARN_FORMAT_INCLUDES_CLUSTER_NAME,IAM_MINIMIZE_POLICIES,IAM_IMPORTED_ROLE_STACK_SAFE_DEFAULT_POLICY_NAME,VALIDATE_SNAPSHOT_REMOVAL_POLICY,CODEPIPELINE_CROSS_ACCOUNT_KEY_ALIAS_STACK_SAFE_RESOURCE_NAME,S3_CREATE_DEFAULT_LOGGING_POLICY,SNS_SUBSCRIPTIONS_SQS_DECRYPTION_POLICY,APIGATEWAY_DISABLE_CLOUDWATCH_ROLE,ENABLE_PARTITION_LITERALS,EVENTS_TARGET_QUEUE_SAME_ACCOUNT,IAM_STANDARDIZED_SERVICE_PRINCIPALS,ECS_DISABLE_EXPLICIT_DEPLOYMENT_CONTROLLER_FOR_CIRCUIT_BREAKER,S3_SERVER_ACCESS_LOGS_USE_BUCKET_POLICY,ROUTE53_PATTERNS_USE_CERTIFICATE,AWS_CUSTOM_RESOURCE_LATEST_SDK_DEFAULT,DATABASE_PROXY_UNIQUE_RESOURCE_NAME,CODEDEPLOY_REMOVE_ALARMS_FROM_DEPLOYMENT_GROUP,APIGATEWAY_AUTHORIZER_CHANGE_DEPLOYMENT_LOGICAL_ID,EC2_LAUNCH_TEMPLATE_DEFAULT_USER_DATA,SECRETS_MANAGER_TARGET_ATTACHMENT_RESOURCE_POLICY,REDSHIFT_COLUMN_ID,ENABLE_EMR_SERVICE_POLICY_V2,EC2_RESTRICT_DEFAULT_SECURITY_GROUP,APIGATEWAY_REQUEST_VALIDATOR_UNIQUE_ID,INCLUDE_PREFIX_IN_UNIQUE_NAME_GENERATION,KMS_ALIAS_NAME_REF,EFS_DENY_ANONYMOUS_ACCESS,EFS_MOUNTTARGET_ORDERINSENSITIVE_LOGICAL_ID,AUTOSCALING_GENERATE_LAUNCH_TEMPLATE,ENABLE_OPENSEARCH_MULTIAZ_WITH_STANDBY,LAMBDA_NODEJS_USE_LATEST_RUNTIME,FLAGS,CURRENT_MV,CURRENT_VERSION_EXPIRED_FLAGS,NEW_PROJECT_CONTEXT,CURRENT_VERSION_FLAG_DEFAULTS,FUTURE_FLAGS_EXPIRED,FUTURE_FLAGS,NEW_PROJECT_DEFAULT_CONTEXT;var init_features=__esm({"../@aws-cdk/cx-api/lib/features.ts"(){"use strict";init_flag_modeling();ENABLE_STACK_NAME_DUPLICATES_CONTEXT="@aws-cdk/core:enableStackNameDuplicates";ENABLE_DIFF_NO_FAIL_CONTEXT="aws-cdk:enableDiffNoFail";ENABLE_DIFF_NO_FAIL=ENABLE_DIFF_NO_FAIL_CONTEXT;NEW_STYLE_STACK_SYNTHESIS_CONTEXT="@aws-cdk/core:newStyleStackSynthesis";STACK_RELATIVE_EXPORTS_CONTEXT="@aws-cdk/core:stackRelativeExports";DOCKER_IGNORE_SUPPORT="@aws-cdk/aws-ecr-assets:dockerIgnoreSupport";SECRETS_MANAGER_PARSE_OWNED_SECRET_NAME="@aws-cdk/aws-secretsmanager:parseOwnedSecretName";KMS_DEFAULT_KEY_POLICIES="@aws-cdk/aws-kms:defaultKeyPolicies";S3_GRANT_WRITE_WITHOUT_ACL="@aws-cdk/aws-s3:grantWriteWithoutAcl";ECS_REMOVE_DEFAULT_DESIRED_COUNT="@aws-cdk/aws-ecs-patterns:removeDefaultDesiredCount";RDS_LOWERCASE_DB_IDENTIFIER="@aws-cdk/aws-rds:lowercaseDbIdentifier";APIGATEWAY_USAGEPLANKEY_ORDERINSENSITIVE_ID="@aws-cdk/aws-apigateway:usagePlanKeyOrderInsensitiveId";EFS_DEFAULT_ENCRYPTION_AT_REST="@aws-cdk/aws-efs:defaultEncryptionAtRest";LAMBDA_RECOGNIZE_VERSION_PROPS="@aws-cdk/aws-lambda:recognizeVersionProps";LAMBDA_RECOGNIZE_LAYER_VERSION="@aws-cdk/aws-lambda:recognizeLayerVersion";CLOUDFRONT_DEFAULT_SECURITY_POLICY_TLS_V1_2_2021="@aws-cdk/aws-cloudfront:defaultSecurityPolicyTLSv1.2_2021";CHECK_SECRET_USAGE="@aws-cdk/core:checkSecretUsage";TARGET_PARTITIONS="@aws-cdk/core:target-partitions";ECS_SERVICE_EXTENSIONS_ENABLE_DEFAULT_LOG_DRIVER="@aws-cdk-containers/ecs-service-extensions:enableDefaultLogDriver";EC2_UNIQUE_IMDSV2_LAUNCH_TEMPLATE_NAME="@aws-cdk/aws-ec2:uniqueImdsv2TemplateName";ECS_ARN_FORMAT_INCLUDES_CLUSTER_NAME="@aws-cdk/aws-ecs:arnFormatIncludesClusterName";IAM_MINIMIZE_POLICIES="@aws-cdk/aws-iam:minimizePolicies";IAM_IMPORTED_ROLE_STACK_SAFE_DEFAULT_POLICY_NAME="@aws-cdk/aws-iam:importedRoleStackSafeDefaultPolicyName";VALIDATE_SNAPSHOT_REMOVAL_POLICY="@aws-cdk/core:validateSnapshotRemovalPolicy";CODEPIPELINE_CROSS_ACCOUNT_KEY_ALIAS_STACK_SAFE_RESOURCE_NAME="@aws-cdk/aws-codepipeline:crossAccountKeyAliasStackSafeResourceName";S3_CREATE_DEFAULT_LOGGING_POLICY="@aws-cdk/aws-s3:createDefaultLoggingPolicy";SNS_SUBSCRIPTIONS_SQS_DECRYPTION_POLICY="@aws-cdk/aws-sns-subscriptions:restrictSqsDescryption";APIGATEWAY_DISABLE_CLOUDWATCH_ROLE="@aws-cdk/aws-apigateway:disableCloudWatchRole";ENABLE_PARTITION_LITERALS="@aws-cdk/core:enablePartitionLiterals";EVENTS_TARGET_QUEUE_SAME_ACCOUNT="@aws-cdk/aws-events:eventsTargetQueueSameAccount";IAM_STANDARDIZED_SERVICE_PRINCIPALS="@aws-cdk/aws-iam:standardizedServicePrincipals";ECS_DISABLE_EXPLICIT_DEPLOYMENT_CONTROLLER_FOR_CIRCUIT_BREAKER="@aws-cdk/aws-ecs:disableExplicitDeploymentControllerForCircuitBreaker";S3_SERVER_ACCESS_LOGS_USE_BUCKET_POLICY="@aws-cdk/aws-s3:serverAccessLogsUseBucketPolicy";ROUTE53_PATTERNS_USE_CERTIFICATE="@aws-cdk/aws-route53-patters:useCertificate";AWS_CUSTOM_RESOURCE_LATEST_SDK_DEFAULT="@aws-cdk/customresources:installLatestAwsSdkDefault";DATABASE_PROXY_UNIQUE_RESOURCE_NAME="@aws-cdk/aws-rds:databaseProxyUniqueResourceName";CODEDEPLOY_REMOVE_ALARMS_FROM_DEPLOYMENT_GROUP="@aws-cdk/aws-codedeploy:removeAlarmsFromDeploymentGroup";APIGATEWAY_AUTHORIZER_CHANGE_DEPLOYMENT_LOGICAL_ID="@aws-cdk/aws-apigateway:authorizerChangeDeploymentLogicalId";EC2_LAUNCH_TEMPLATE_DEFAULT_USER_DATA="@aws-cdk/aws-ec2:launchTemplateDefaultUserData";SECRETS_MANAGER_TARGET_ATTACHMENT_RESOURCE_POLICY="@aws-cdk/aws-secretsmanager:useAttachedSecretResourcePolicyForSecretTargetAttachments";REDSHIFT_COLUMN_ID="@aws-cdk/aws-redshift:columnId";ENABLE_EMR_SERVICE_POLICY_V2="@aws-cdk/aws-stepfunctions-tasks:enableEmrServicePolicyV2";EC2_RESTRICT_DEFAULT_SECURITY_GROUP="@aws-cdk/aws-ec2:restrictDefaultSecurityGroup";APIGATEWAY_REQUEST_VALIDATOR_UNIQUE_ID="@aws-cdk/aws-apigateway:requestValidatorUniqueId";INCLUDE_PREFIX_IN_UNIQUE_NAME_GENERATION="@aws-cdk/core:includePrefixInUniqueNameGeneration";KMS_ALIAS_NAME_REF="@aws-cdk/aws-kms:aliasNameRef";EFS_DENY_ANONYMOUS_ACCESS="@aws-cdk/aws-efs:denyAnonymousAccess";EFS_MOUNTTARGET_ORDERINSENSITIVE_LOGICAL_ID="@aws-cdk/aws-efs:mountTargetOrderInsensitiveLogicalId";AUTOSCALING_GENERATE_LAUNCH_TEMPLATE="@aws-cdk/aws-autoscaling:generateLaunchTemplateInsteadOfLaunchConfig";ENABLE_OPENSEARCH_MULTIAZ_WITH_STANDBY="@aws-cdk/aws-opensearchservice:enableOpensearchMultiAzWithStandby";LAMBDA_NODEJS_USE_LATEST_RUNTIME="@aws-cdk/aws-lambda-nodejs:useLatestRuntimeVersion";FLAGS={[ENABLE_STACK_NAME_DUPLICATES_CONTEXT]:{type:0,summary:"Allow multiple stacks with the same name",detailsMd:`
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

SyntaxError: Unexpected token '?'
    at wrapSafe (internal/modules/cjs/loader.js:915:16)
    at Module._compile (internal/modules/cjs/loader.js:963:27)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:1027:10)
    at Module.load (internal/modules/cjs/loader.js:863:32)
    at Function.Module._load (internal/modules/cjs/loader.js:708:14)
    at Module.require (internal/modules/cjs/loader.js:887:19)
    at require (internal/modules/cjs/helpers.js:74:18)
    at Object.<anonymous> (/usr/local/lib/node_modules/aws-cdk/bin/cdk.js:3:15)
    at Module._compile (internal/modules/cjs/loader.js:999:30)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:1027:10)
/usr/local/lib/node_modules/aws-cdk/lib/index.js:2
${errors.map(e=>e.stack).join("\n")}`)}}static saveManifest(manifest,filePath,schema4,preprocess){let withVersion={...manifest,version:_Manifest.version()};_Manifest.validate(withVersion,schema4);if(preprocess){withVersion=preprocess(withVersion)}fs.writeFileSync(filePath,JSON.stringify(withVersion,void 0,2))}static loadManifest(filePath,schema4,preprocess,options){const contents=fs.readFileSync(filePath,{encoding:"utf-8"});let obj;try{obj=JSON.parse(contents)}catch(e){throw new Error(`${e.message}, while parsing ${JSON.stringify(contents)}`)}if(preprocess){obj=preprocess(obj)}_Manifest.validate(obj,schema4,options);return obj}static patchStackTagsOnRead(manifest){return _Manifest.replaceStackTags(manifest,tags=>tags.map(diskTag=>({key:diskTag.Key,value:diskTag.Value})))}static patchStackTagsOnWrite(manifest){return _Manifest.replaceStackTags(manifest,tags=>tags.map(memTag=>"Key"in memTag?memTag:{Key:memTag.key,Value:memTag.value}))}static replaceStackTags(manifest,fn){return noUndefined({...manifest,artifacts:mapValues(manifest.artifacts,artifact=>{if(artifact.type!=="aws:cloudformation:stack"){return artifact}return noUndefined({...artifact,metadata:mapValues(artifact.metadata,metadataEntries=>metadataEntries.map(metadataEntry=>{if(metadataEntry.type!=="aws:cdk:stack-tags"||!metadataEntry.data){return metadataEntry}return{...metadataEntry,data:fn(metadataEntry.data)}}))})})})}constructor(){}}}});var init_schema3=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/schema.ts"(){"use strict"}});var RequireApproval;var init_common=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/commands/common.ts"(){"use strict";RequireApproval=(RequireApproval3=>{RequireApproval3["NEVER"]="never";RequireApproval3["ANYCHANGE"]="any-change";RequireApproval3["BROADENING"]="broadening";return RequireApproval3})(RequireApproval||{})}});var init_deploy=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/commands/deploy.ts"(){"use strict"}});var init_destroy=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/commands/destroy.ts"(){"use strict"}});var init_commands=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/commands/index.ts"(){"use strict";init_common();init_deploy();init_destroy()}});var init_test_case=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/test-case.ts"(){"use strict"}});var integ_tests_exports={};__export(integ_tests_exports,{RequireApproval:()=>RequireApproval});var init_integ_tests=__esm({"../@aws-cdk/cloud-assembly-schema/lib/integ-tests/index.ts"(){"use strict";init_schema3();init_commands();init_test_case()}});var require_lib2=__commonJS({"../@aws-cdk/cloud-assembly-schema/lib/index.js"(exports2){"use strict";var __createBinding3=exports2&&exports2.__createBinding||(Object.create?function(o,m,k,k2){if(k2===void 0)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===void 0)k2=k;o[k2]=m[k]});var __exportStar3=exports2&&exports2.__exportStar||function(m,exports3){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports3,p))__createBinding3(exports3,m,p)};Object.defineProperty(exports2,"__esModule",{value:true});__exportStar3((init_cloud_assembly(),__toCommonJS(cloud_assembly_exports)),exports2);__exportStar3((init_assets(),__toCommonJS(assets_exports)),exports2);__exportStar3((init_manifest(),__toCommonJS(manifest_exports)),exports2);__exportStar3((init_integ_tests(),__toCommonJS(integ_tests_exports)),exports2)}});var cxapi_exports={};__export(cxapi_exports,{CLI_ASM_VERSION_ENV:()=>CLI_ASM_VERSION_ENV,CLI_VERSION_ENV:()=>CLI_VERSION_ENV,CONTEXT_ENV:()=>CONTEXT_ENV,CONTEXT_OVERFLOW_LOCATION_ENV:()=>CONTEXT_OVERFLOW_LOCATION_ENV,DEFAULT_ACCOUNT_ENV:()=>DEFAULT_ACCOUNT_ENV,DEFAULT_REGION_ENV:()=>DEFAULT_REGION_ENV,OUTDIR_ENV:()=>OUTDIR_ENV,PROVIDER_ERROR_KEY:()=>PROVIDER_ERROR_KEY,SSMPARAM_NO_INVALIDATE:()=>SSMPARAM_NO_INVALIDATE});var OUTDIR_ENV,CONTEXT_ENV,CONTEXT_OVERFLOW_LOCATION_ENV,DEFAULT_ACCOUNT_ENV,DEFAULT_REGION_ENV,CLI_ASM_VERSION_ENV,CLI_VERSION_ENV,PROVIDER_ERROR_KEY,SSMPARAM_NO_INVALIDATE;var init_cxapi=__esm({"../@aws-cdk/cx-api/lib/cxapi.ts"(){"use strict";OUTDIR_ENV="CDK_OUTDIR";CONTEXT_ENV="CDK_CONTEXT_JSON";CONTEXT_OVERFLOW_LOCATION_ENV="CONTEXT_OVERFLOW_LOCATION_ENV";DEFAULT_ACCOUNT_ENV="CDK_DEFAULT_ACCOUNT";DEFAULT_REGION_ENV="CDK_DEFAULT_REGION";CLI_ASM_VERSION_ENV="CDK_CLI_ASM_VERSION";CLI_VERSION_ENV="CDK_CLI_VERSION";PROVIDER_ERROR_KEY="$providerError";SSMPARAM_NO_INVALIDATE="[cdk:skip]"}});var vpc_exports={};__export(vpc_exports,{VpcSubnetGroupType:()=>VpcSubnetGroupType});var VpcSubnetGroupType;var init_vpc=__esm({"../@aws-cdk/cx-api/lib/context/vpc.ts"(){"use strict";VpcSubnetGroupType=(VpcSubnetGroupType3=>{VpcSubnetGroupType3["PUBLIC"]="Public";VpcSubnetGroupType3["PRIVATE"]="Private";VpcSubnetGroupType3["ISOLATED"]="Isolated";return VpcSubnetGroupType3})(VpcSubnetGroupType||{})}});var ami_exports={};var init_ami=__esm({"../@aws-cdk/cx-api/lib/context/ami.ts"(){"use strict"}});var load_balancer_exports={};__export(load_balancer_exports,{LoadBalancerIpAddressType:()=>LoadBalancerIpAddressType});var LoadBalancerIpAddressType;var init_load_balancer=__esm({"../@aws-cdk/cx-api/lib/context/load-balancer.ts"(){"use strict";LoadBalancerIpAddressType=(LoadBalancerIpAddressType3=>{LoadBalancerIpAddressType3["IPV4"]="ipv4";LoadBalancerIpAddressType3["DUAL_STACK"]="dualstack";return LoadBalancerIpAddressType3})(LoadBalancerIpAddressType||{})}});var availability_zones_exports={};__export(availability_zones_exports,{AVAILABILITY_ZONE_FALLBACK_CONTEXT_KEY:()=>AVAILABILITY_ZONE_FALLBACK_CONTEXT_KEY});var AVAILABILITY_ZONE_FALLBACK_CONTEXT_KEY;var init_availability_zones=__esm({"../@aws-cdk/cx-api/lib/context/availability-zones.ts"(){"use strict";AVAILABILITY_ZONE_FALLBACK_CONTEXT_KEY="aws:cdk:availability-zones:fallback"}});var endpoint_service_availability_zones_exports={};__export(endpoint_service_availability_zones_exports,{ENDPOINT_SERVICE_AVAILABILITY_ZONE_PROVIDER:()=>ENDPOINT_SERVICE_AVAILABILITY_ZONE_PROVIDER});var ENDPOINT_SERVICE_AVAILABILITY_ZONE_PROVIDER;var init_endpoint_service_availability_zones=__esm({"../@aws-cdk/cx-api/lib/context/endpoint-service-availability-zones.ts"(){"use strict";ENDPOINT_SERVICE_AVAILABILITY_ZONE_PROVIDER="endpoint-service-availability-zones"}});var security_group_exports={};var init_security_group=__esm({"../@aws-cdk/cx-api/lib/context/security-group.ts"(){"use strict"}});var key_exports={};var init_key=__esm({"../@aws-cdk/cx-api/lib/context/key.ts"(){"use strict"}});var metadata_exports={};__export(metadata_exports,{PATH_METADATA_KEY:()=>PATH_METADATA_KEY,SynthesisMessageLevel:()=>SynthesisMessageLevel});var PATH_METADATA_KEY,SynthesisMessageLevel;var init_metadata=__esm({"../@aws-cdk/cx-api/lib/metadata.ts"(){"use strict";PATH_METADATA_KEY="aws:cdk:path";SynthesisMessageLevel=(SynthesisMessageLevel3=>{SynthesisMessageLevel3["INFO"]="info";SynthesisMessageLevel3["WARNING"]="warning";SynthesisMessageLevel3["ERROR"]="error";return SynthesisMessageLevel3})(SynthesisMessageLevel||{})}});var cloud_artifact_exports={};__export(cloud_artifact_exports,{CloudArtifact:()=>CloudArtifact});var cxschema,CloudArtifact;var init_cloud_artifact=__esm({"../@aws-cdk/cx-api/lib/cloud-artifact.ts"(){"use strict";init_metadata();cxschema=__toESM(require_lib2());CloudArtifact=class{constructor(assembly,id,manifest){this.assembly=assembly;this.id=id;this.manifest=manifest;this.messages=this.renderMessages();this._dependencyIDs=manifest.dependencies||[]}static fromManifest(assembly,id,artifact){void 0,void 0,void 0;throw new Error("Implementation not overridden yet")}get dependencies(){if(this._deps){return this._deps}this._deps=this._dependencyIDs.map(id=>{const dep=this.assembly.tryGetArtifact(id);if(!dep){throw new Error(`Artifact ${this.id} depends on non-existing artifact ${id}`)}return dep});return this._deps}findMetadataByType(type){const result=new Array;for(const path30 of Object.keys(this.manifest.metadata||{})){for(const entry of(this.manifest.metadata||{})[path30]){if(entry.type===type){result.push({path:path30,...entry})}}}return result}renderMessages(){const messages=new Array;for(const[id,metadata]of Object.entries(this.manifest.metadata||{})){for(const entry of metadata){let level;switch(entry.type){case cxschema.ArtifactMetadataEntryType.WARN:level="warning";break;case cxschema.ArtifactMetadataEntryType.ERROR:level="error";break;case cxschema.ArtifactMetadataEntryType.INFO:level="info";break;default:continue}messages.push({level,entry,id})}}return messages}get hierarchicalId(){return this.manifest.displayName??this.id}}}});var asset_manifest_artifact_exports={};__export(asset_manifest_artifact_exports,{AssetManifestArtifact:()=>AssetManifestArtifact});var fs2,path,ASSET_MANIFEST_ARTIFACT_SYM,AssetManifestArtifact;var init_asset_manifest_artifact=__esm({"../@aws-cdk/cx-api/lib/artifacts/asset-manifest-artifact.ts"(){"use strict";fs2=__toESM(require("fs"));path=__toESM(require("path"));init_cloud_artifact();ASSET_MANIFEST_ARTIFACT_SYM=Symbol.for("@aws-cdk/cx-api.AssetManifestArtifact");AssetManifestArtifact=class extends CloudArtifact{constructor(assembly,name,artifact){super(assembly,name,artifact);const properties=this.manifest.properties||{};if(!properties.file){throw new Error('Invalid AssetManifestArtifact. Missing "file" property')}this.file=path.resolve(this.assembly.directory,properties.file);this.requiresBootstrapStackVersion=properties.requiresBootstrapStackVersion;this.bootstrapStackVersionSsmParameter=properties.bootstrapStackVersionSsmParameter}static isAssetManifestArtifact(art){return art&&typeof art==="object"&&art[ASSET_MANIFEST_ARTIFACT_SYM]}get contents(){if(this._contents!==void 0){return this._contents}const contents=this._contents=JSON.parse(fs2.readFileSync(this.file,"utf-8"));return contents}};Object.defineProperty(AssetManifestArtifact.prototype,ASSET_MANIFEST_ARTIFACT_SYM,{value:true,enumerable:false,writable:false})}});var environment_exports={};__export(environment_exports,{EnvironmentUtils:()=>EnvironmentUtils,UNKNOWN_ACCOUNT:()=>UNKNOWN_ACCOUNT,UNKNOWN_REGION:()=>UNKNOWN_REGION});var AWS_ENV_REGEX,UNKNOWN_ACCOUNT,UNKNOWN_REGION,EnvironmentUtils;var init_environment=__esm({"../@aws-cdk/cx-api/lib/environment.ts"(){"use strict";AWS_ENV_REGEX=/aws\:\/\/([a-z0-9A-Z\-\@\.\_]+)\/([a-z\-0-9]+)/;UNKNOWN_ACCOUNT="unknown-account";UNKNOWN_REGION="unknown-region";EnvironmentUtils=class{static parse(environment){const env2=AWS_ENV_REGEX.exec(environment);if(!env2){throw new Error(`Unable to parse environment specification "${environment}". Expected format: aws://account/region`)}const[,account,region]=env2;if(!account||!region){throw new Error(`Invalid environment specification: ${environment}`)}return{account,region,name:environment}}static make(account,region){return{account,region,name:this.format(account,region)}}static format(account,region){return`aws://${account}/${region}`}}}});var cloudformation_artifact_exports={};__export(cloudformation_artifact_exports,{CloudFormationStackArtifact:()=>CloudFormationStackArtifact});var fs3,path2,cxschema2,CLOUDFORMATION_STACK_ARTIFACT_SYM,CloudFormationStackArtifact;var init_cloudformation_artifact=__esm({"../@aws-cdk/cx-api/lib/artifacts/cloudformation-artifact.ts"(){"use strict";fs3=__toESM(require("fs"));path2=__toESM(require("path"));cxschema2=__toESM(require_lib2());init_cloud_artifact();init_environment();CLOUDFORMATION_STACK_ARTIFACT_SYM=Symbol.for("@aws-cdk/cx-api.CloudFormationStackArtifact");CloudFormationStackArtifact=class extends CloudArtifact{constructor(assembly,artifactId,artifact){super(assembly,artifactId,artifact);const properties=this.manifest.properties||{};if(!properties.templateFile){throw new Error('Invalid CloudFormation stack artifact. Missing "templateFile" property in cloud assembly manifest')}if(!artifact.environment){throw new Error("Invalid CloudFormation stack artifact. Missing environment")}this.environment=EnvironmentUtils.parse(artifact.environment);this.templateFile=properties.templateFile;this.parameters=properties.parameters??{};this.tags=properties.tags??this.tagsFromMetadata();this.assumeRoleArn=properties.assumeRoleArn;this.assumeRoleExternalId=properties.assumeRoleExternalId;this.cloudFormationExecutionRoleArn=properties.cloudFormationExecutionRoleArn;this.stackTemplateAssetObjectUrl=properties.stackTemplateAssetObjectUrl;this.requiresBootstrapStackVersion=properties.requiresBootstrapStackVersion;this.bootstrapStackVersionSsmParameter=properties.bootstrapStackVersionSsmParameter;this.terminationProtection=properties.terminationProtection;this.validateOnSynth=properties.validateOnSynth;this.lookupRole=properties.lookupRole;this.stackName=properties.stackName||artifactId;this.assets=this.findMetadataByType(cxschema2.ArtifactMetadataEntryType.ASSET).map(e=>e.data);this.displayName=this.stackName===artifactId?this.hierarchicalId:`${this.hierarchicalId} (${this.stackName})`;this.name=this.stackName;this.originalName=this.stackName}static isCloudFormationStackArtifact(art){return art&&typeof art==="object"&&art[CLOUDFORMATION_STACK_ARTIFACT_SYM]}get templateFullPath(){return path2.join(this.assembly.directory,this.templateFile)}get template(){if(this._template===void 0){this._template=JSON.parse(fs3.readFileSync(this.templateFullPath,"utf-8"))}return this._template}tagsFromMetadata(){const ret={};for(const metadataEntry of this.findMetadataByType(cxschema2.ArtifactMetadataEntryType.STACK_TAGS)){for(const tag of metadataEntry.data??[]){ret[tag.key]=tag.value}}return ret}};Object.defineProperty(CloudFormationStackArtifact.prototype,CLOUDFORMATION_STACK_ARTIFACT_SYM,{value:true,enumerable:false,writable:false})}});var nested_cloud_assembly_artifact_exports={};__export(nested_cloud_assembly_artifact_exports,{NestedCloudAssemblyArtifact:()=>NestedCloudAssemblyArtifact});var path3,NESTED_CLOUD_ASSEMBLY_SYM,NestedCloudAssemblyArtifact;var init_nested_cloud_assembly_artifact=__esm({"../@aws-cdk/cx-api/lib/artifacts/nested-cloud-assembly-artifact.ts"(){"use strict";path3=__toESM(require("path"));init_cloud_artifact();NESTED_CLOUD_ASSEMBLY_SYM=Symbol.for("@aws-cdk/cx-api.NestedCloudAssemblyArtifact");NestedCloudAssemblyArtifact=class extends CloudArtifact{constructor(assembly,name,artifact){super(assembly,name,artifact);const properties=this.manifest.properties||{};this.directoryName=properties.directoryName;this.displayName=properties.displayName??name}static isNestedCloudAssemblyArtifact(art){return art&&typeof art==="object"&&art[NESTED_CLOUD_ASSEMBLY_SYM]}get fullPath(){return path3.join(this.assembly.directory,this.directoryName)}};Object.defineProperty(NestedCloudAssemblyArtifact.prototype,NESTED_CLOUD_ASSEMBLY_SYM,{value:true,enumerable:false,writable:false})}});var tree_cloud_artifact_exports={};__export(tree_cloud_artifact_exports,{TreeCloudArtifact:()=>TreeCloudArtifact});var TREE_CLOUD_ARTIFACT_SYM,TreeCloudArtifact;var init_tree_cloud_artifact=__esm({"../@aws-cdk/cx-api/lib/artifacts/tree-cloud-artifact.ts"(){"use strict";init_cloud_artifact();TREE_CLOUD_ARTIFACT_SYM=Symbol.for("@aws-cdk/cx-api.TreeCloudArtifact");TreeCloudArtifact=class extends CloudArtifact{constructor(assembly,name,artifact){super(assembly,name,artifact);const properties=this.manifest.properties||{};if(!properties.file){throw new Error('Invalid TreeCloudArtifact. Missing "file" property')}this.file=properties.file}static isTreeCloudArtifact(art){return art&&typeof art==="object"&&art[TREE_CLOUD_ARTIFACT_SYM]}};Object.defineProperty(TreeCloudArtifact.prototype,TREE_CLOUD_ARTIFACT_SYM,{value:true,enumerable:false,writable:false})}});var cloud_artifact_aug_exports={};var cxschema3;var init_cloud_artifact_aug=__esm({"../@aws-cdk/cx-api/lib/cloud-artifact-aug.ts"(){"use strict";init_asset_manifest_artifact();init_cloudformation_artifact();init_nested_cloud_assembly_artifact();init_tree_cloud_artifact();init_cloud_artifact();cxschema3=__toESM(require_lib2());CloudArtifact.fromManifest=function fromManifest(assembly,id,artifact){switch(artifact.type){case cxschema3.ArtifactType.AWS_CLOUDFORMATION_STACK:return new CloudFormationStackArtifact(assembly,id,artifact);case cxschema3.ArtifactType.CDK_TREE:return new TreeCloudArtifact(assembly,id,artifact);case cxschema3.ArtifactType.ASSET_MANIFEST:return new AssetManifestArtifact(assembly,id,artifact);case cxschema3.ArtifactType.NESTED_CLOUD_ASSEMBLY:return new NestedCloudAssemblyArtifact(assembly,id,artifact);default:return void 0}}}});function topologicalSort(xs,keyFn,depFn){const remaining=new Map;for(const element of xs){const key=keyFn(element);remaining.set(key,{key,element,dependencies:depFn(element)})}const ret=new Array;while(remaining.size>0){const selectable=Array.from(remaining.values()).filter(e=>e.dependencies.every(d=>!remaining.has(d)));selectable.sort((a,b)=>a.key<b.key?-1:b.key<a.key?1:0);for(const selected of selectable){ret.push(selected.element);remaining.delete(selected.key)}if(selectable.length===0){throw new Error(`Could not determine ordering between: ${Array.from(remaining.keys()).join(", ")}`)}}return ret}var init_toposort=__esm({"../@aws-cdk/cx-api/lib/toposort.ts"(){"use strict"}});var cloud_assembly_exports2={};__export(cloud_assembly_exports2,{CloudAssembly:()=>CloudAssembly,CloudAssemblyBuilder:()=>CloudAssemblyBuilder});function filterUndefined(obj){if(Array.isArray(obj)){return obj.filter(x=>x!==void 0).map(x=>filterUndefined(x))}if(typeof obj==="object"){const ret={};for(const[key,value]of Object.entries(obj)){if(value===void 0){continue}ret[key]=filterUndefined(value)}return ret}return obj}function ignore(_x){return}function determineOutputDirectory(outdir){return outdir??fs4.mkdtempSync(path4.join(fs4.realpathSync(os.tmpdir()),"cdk.out"))}function ensureDirSync(dir){if(fs4.existsSync(dir)){if(!fs4.statSync(dir).isDirectory()){throw new Error(`${dir} must be a directory`)}}else{fs4.mkdirSync(dir,{recursive:true})}}var fs4,os,path4,cxschema4,MANIFEST_FILE,CloudAssembly,CloudAssemblyBuilder;var init_cloud_assembly2=__esm({"../@aws-cdk/cx-api/lib/cloud-assembly.ts"(){"use strict";fs4=__toESM(require("fs"));os=__toESM(require("os"));path4=__toESM(require("path"));init_cloudformation_artifact();init_nested_cloud_assembly_artifact();init_tree_cloud_artifact();init_cloud_artifact();init_toposort();cxschema4=__toESM(require_lib2());MANIFEST_FILE="manifest.json";CloudAssembly=class{constructor(directory,loadOptions){this.directory=directory;this.manifest=cxschema4.Manifest.loadAssemblyManifest(path4.join(directory,MANIFEST_FILE),loadOptions);this.version=this.manifest.version;this.artifacts=this.renderArtifacts((loadOptions==null?void 0:loadOptions.topoSort)??true);this.runtime=this.manifest.runtime||{libraries:{}};this.validateDeps()}tryGetArtifact(id){return this.artifacts.find(a=>a.id===id)}getStackByName(stackName){const artifacts=this.artifacts.filter(a=>a instanceof CloudFormationStackArtifact&&a.stackName===stackName);if(!artifacts||artifacts.length===0){throw new Error(`Unable to find stack with stack name "${stackName}"`)}if(artifacts.length>1){throw new Error(`There are multiple stacks with the stack name "${stackName}" (${artifacts.map(a=>a.id).join(",")}). Use "getStackArtifact(id)" instead`)}return artifacts[0]}getStack(stackName){return this.getStackByName(stackName)}getStackArtifact(artifactId){const artifact=this.tryGetArtifactRecursively(artifactId);if(!artifact){throw new Error(`Unable to find artifact with id "${artifactId}"`)}if(!(artifact instanceof CloudFormationStackArtifact)){throw new Error(`Artifact ${artifactId} is not a CloudFormation stack`)}return artifact}tryGetArtifactRecursively(artifactId){return this.stacksRecursively.find(a=>a.id===artifactId)}get stacksRecursively(){function search(stackArtifacts,assemblies){if(assemblies.length===0){return stackArtifacts}const[head,...tail]=assemblies;const nestedAssemblies=head.nestedAssemblies.map(asm=>asm.nestedAssembly);return search(stackArtifacts.concat(head.stacks),tail.concat(nestedAssemblies))};return search([],[this])}getNestedAssemblyArtifact(artifactId){const artifact=this.tryGetArtifact(artifactId);if(!artifact){throw new Error(`Unable to find artifact with id "${artifactId}"`)}if(!(artifact instanceof NestedCloudAssemblyArtifact)){throw new Error(`Found artifact '${artifactId}' but it's not a nested cloud assembly`)}return artifact}getNestedAssembly(artifactId){return this.getNestedAssemblyArtifact(artifactId).nestedAssembly}tree(){const trees=this.artifacts.filter(a=>a.manifest.type===cxschema4.ArtifactType.CDK_TREE);if(trees.length===0){return void 0}else if(trees.length>1){throw new Error(`Multiple artifacts of type ${cxschema4.ArtifactType.CDK_TREE} found in manifest`)}const tree=trees[0];if(!(tree instanceof TreeCloudArtifact)){throw new Error('"Tree" artifact is not of expected type')}return tree}get stacks(){return this.artifacts.filter(isCloudFormationStackArtifact);function isCloudFormationStackArtifact(x){return x instanceof CloudFormationStackArtifact}}get nestedAssemblies(){return this.artifacts.filter(isNestedCloudAssemblyArtifact);function isNestedCloudAssemblyArtifact(x){return x instanceof NestedCloudAssemblyArtifact}}validateDeps(){for(const artifact of this.artifacts){ignore(artifact.dependencies)}}renderArtifacts(topoSort){const result=new Array;for(const[name,artifact]of Object.entries(this.manifest.artifacts||{})){const cloudartifact=CloudArtifact.fromManifest(this,name,artifact);if(cloudartifact){result.push(cloudartifact)}}return topoSort?topologicalSort(result,x=>x.id,x=>x._dependencyIDs):result}};CloudAssemblyBuilder=class _CloudAssemblyBuilder{constructor(outdir,props={}){this.artifacts={};this.missing=new Array;this.outdir=determineOutputDirectory(outdir);this.assetOutdir=props.assetOutdir??this.outdir;this.parentBuilder=props.parentBuilder;ensureDirSync(this.outdir)}addArtifact(id,manifest){this.artifacts[id]=filterUndefined(manifest)}addMissing(missing){var _a;if(this.missing.every(m=>m.key!==missing.key)){this.missing.push(missing)}(_a=this.parentBuilder)==null?void 0:_a.addMissing(missing)}buildAssembly(options={}){let manifest={version:cxschema4.Manifest.version(),artifacts:this.artifacts,runtime:options.runtimeInfo,missing:this.missing.length>0?this.missing:void 0};manifest=filterUndefined(manifest);const manifestFilePath=path4.join(this.outdir,MANIFEST_FILE);cxschema4.Manifest.saveAssemblyManifest(manifest,manifestFilePath);fs4.writeFileSync(path4.join(this.outdir,"cdk.out"),JSON.stringify({version:manifest.version}));return new CloudAssembly(this.outdir)}createNestedAssembly(artifactId,displayName){const directoryName=artifactId;const innerAsmDir=path4.join(this.outdir,directoryName);this.addArtifact(artifactId,{type:cxschema4.ArtifactType.NESTED_CLOUD_ASSEMBLY,properties:{directoryName,displayName}});return new _CloudAssemblyBuilder(innerAsmDir,{assetOutdir:this.assetOutdir,parentBuilder:this})}delete(){fs4.rmSync(this.outdir,{recursive:true,force:true})}}}});var nested_cloud_assembly_artifact_aug_exports={};var cacheSym;var init_nested_cloud_assembly_artifact_aug=__esm({"../@aws-cdk/cx-api/lib/artifacts/nested-cloud-assembly-artifact-aug.ts"(){"use strict";init_nested_cloud_assembly_artifact();init_cloud_assembly2();cacheSym=Symbol();Object.defineProperty(NestedCloudAssemblyArtifact.prototype,"nestedAssembly",{get(){if(!this[cacheSym]){this[cacheSym]=new CloudAssembly(this.fullPath)}return this[cacheSym]}})}});var assets_exports2={};__export(assets_exports2,{ASSET_PREFIX_SEPARATOR:()=>ASSET_PREFIX_SEPARATOR,ASSET_RESOURCE_METADATA_DOCKERFILE_PATH_KEY:()=>ASSET_RESOURCE_METADATA_DOCKERFILE_PATH_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_ARGS_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_BUILD_ARGS_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_SECRETS_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_BUILD_SECRETS_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_SSH_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_BUILD_SSH_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_TARGET_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_BUILD_TARGET_KEY,ASSET_RESOURCE_METADATA_DOCKER_CACHE_FROM_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_CACHE_FROM_KEY,ASSET_RESOURCE_METADATA_DOCKER_CACHE_TO_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_CACHE_TO_KEY,ASSET_RESOURCE_METADATA_DOCKER_OUTPUTS_KEY:()=>ASSET_RESOURCE_METADATA_DOCKER_OUTPUTS_KEY,ASSET_RESOURCE_METADATA_ENABLED_CONTEXT:()=>ASSET_RESOURCE_METADATA_ENABLED_CONTEXT,ASSET_RESOURCE_METADATA_IS_BUNDLED_KEY:()=>ASSET_RESOURCE_METADATA_IS_BUNDLED_KEY,ASSET_RESOURCE_METADATA_PATH_KEY:()=>ASSET_RESOURCE_METADATA_PATH_KEY,ASSET_RESOURCE_METADATA_PROPERTY_KEY:()=>ASSET_RESOURCE_METADATA_PROPERTY_KEY});var ASSET_RESOURCE_METADATA_ENABLED_CONTEXT,ASSET_RESOURCE_METADATA_PATH_KEY,ASSET_RESOURCE_METADATA_DOCKERFILE_PATH_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_ARGS_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_SECRETS_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_SSH_KEY,ASSET_RESOURCE_METADATA_DOCKER_BUILD_TARGET_KEY,ASSET_RESOURCE_METADATA_PROPERTY_KEY,ASSET_RESOURCE_METADATA_IS_BUNDLED_KEY,ASSET_RESOURCE_METADATA_DOCKER_OUTPUTS_KEY,ASSET_RESOURCE_METADATA_DOCKER_CACHE_FROM_KEY,ASSET_RESOURCE_METADATA_DOCKER_CACHE_TO_KEY,ASSET_PREFIX_SEPARATOR;var init_assets2=__esm({"../@aws-cdk/cx-api/lib/assets.ts"(){"use strict";ASSET_RESOURCE_METADATA_ENABLED_CONTEXT="aws:cdk:enable-asset-metadata";ASSET_RESOURCE_METADATA_PATH_KEY="aws:asset:path";ASSET_RESOURCE_METADATA_DOCKERFILE_PATH_KEY="aws:asset:dockerfile-path";ASSET_RESOURCE_METADATA_DOCKER_BUILD_ARGS_KEY="aws:asset:docker-build-args";ASSET_RESOURCE_METADATA_DOCKER_BUILD_SECRETS_KEY="aws:asset:docker-build-secrets";ASSET_RESOURCE_METADATA_DOCKER_BUILD_SSH_KEY="aws:asset:docker-build-ssh";ASSET_RESOURCE_METADATA_DOCKER_BUILD_TARGET_KEY="aws:asset:docker-build-target";ASSET_RESOURCE_METADATA_PROPERTY_KEY="aws:asset:property";ASSET_RESOURCE_METADATA_IS_BUNDLED_KEY="aws:asset:is-bundled";ASSET_RESOURCE_METADATA_DOCKER_OUTPUTS_KEY="aws:asset:docker-outputs";ASSET_RESOURCE_METADATA_DOCKER_CACHE_FROM_KEY="aws:asset:docker-cache-from";ASSET_RESOURCE_METADATA_DOCKER_CACHE_TO_KEY="aws:asset:docker-cache-to";ASSET_PREFIX_SEPARATOR="||"}});var init_flag_modeling=__esm({"../@aws-cdk/cx-api/lib/private/flag-modeling.ts"(){"use strict"}});var features_exports={};__export(features_exports,{APIGATEWAY_AUTHORIZER_CHANGE_DEPLOYMENT_LOGICAL_ID:()=>APIGATEWAY_AUTHORIZER_CHANGE_DEPLOYMENT_LOGICAL_ID,APIGATEWAY_DISABLE_CLOUDWATCH_ROLE:()=>APIGATEWAY_DISABLE_CLOUDWATCH_ROLE,APIGATEWAY_REQUEST_VALIDATOR_UNIQUE_ID:()=>APIGATEWAY_REQUEST_VALIDATOR_UNIQUE_ID,APIGATEWAY_USAGEPLANKEY_ORDERINSENSITIVE_ID:()=>APIGATEWAY_USAGEPLANKEY_ORDERINSENSITIVE_ID,AUTOSCALING_GENERATE_LAUNCH_TEMPLATE:()=>AUTOSCALING_GENERATE_LAUNCH_TEMPLATE,AWS_CUSTOM_RESOURCE_LATEST_SDK_DEFAULT:()=>AWS_CUSTOM_RESOURCE_LATEST_SDK_DEFAULT,CHECK_SECRET_USAGE:()=>CHECK_SECRET_USAGE,CLOUDFRONT_DEFAULT_SECURITY_POLICY_TLS_V1_2_2021:()=>CLOUDFRONT_DEFAULT_SECURITY_POLICY_TLS_V1_2_2021,CODEDEPLOY_REMOVE_ALARMS_FROM_DEPLOYMENT_GROUP:()=>CODEDEPLOY_REMOVE_ALARMS_FROM_DEPLOYMENT_GROUP,CODEPIPELINE_CROSS_ACCOUNT_KEY_ALIAS_STACK_SAFE_RESOURCE_NAME:()=>CODEPIPELINE_CROSS_ACCOUNT_KEY_ALIAS_STACK_SAFE_RESOURCE_NAME,CURRENT_VERSION_EXPIRED_FLAGS:()=>CURRENT_VERSION_EXPIRED_FLAGS,CURRENT_VERSION_FLAG_DEFAULTS:()=>CURRENT_VERSION_FLAG_DEFAULTS,DATABASE_PROXY_UNIQUE_RESOURCE_NAME:()=>DATABASE_PROXY_UNIQUE_RESOURCE_NAME,DOCKER_IGNORE_SUPPORT:()=>DOCKER_IGNORE_SUPPORT,EC2_LAUNCH_TEMPLATE_DEFAULT_USER_DATA:()=>EC2_LAUNCH_TEMPLATE_DEFAULT_USER_DATA,EC2_RESTRICT_DEFAULT_SECURITY_GROUP:()=>EC2_RESTRICT_DEFAULT_SECURITY_GROUP,EC2_UNIQUE_IMDSV2_LAUNCH_TEMPLATE_NAME:()=>EC2_UNIQUE_IMDSV2_LAUNCH_TEMPLATE_NAME,ECS_ARN_FORMAT_INCLUDES_CLUSTER_NAME:()=>ECS_ARN_FORMAT_INCLUDES_CLUSTER_NAME,ECS_DISABLE_EXPLICIT_DEPLOYMENT_CONTROLLER_FOR_CIRCUIT_BREAKER:()=>ECS_DISABLE_EXPLICIT_DEPLOYMENT_CONTROLLER_FOR_CIRCUIT_BREAKER,ECS_REMOVE_DEFAULT_DESIRED_COUNT:()=>ECS_REMOVE_DEFAULT_DESIRED_COUNT,ECS_SERVICE_EXTENSIONS_ENABLE_DEFAULT_LOG_DRIVER:()=>ECS_SERVICE_EXTENSIONS_ENABLE_DEFAULT_LOG_DRIVER,EFS_DEFAULT_ENCRYPTION_AT_REST:()=>EFS_DEFAULT_ENCRYPTION_AT_REST,EFS_DENY_ANONYMOUS_ACCESS:()=>EFS_DENY_ANONYMOUS_ACCESS,EFS_MOUNTTARGET_ORDERINSENSITIVE_LOGICAL_ID:()=>EFS_MOUNTTARGET_ORDERINSENSITIVE_LOGICAL_ID,ENABLE_DIFF_NO_FAIL:()=>ENABLE_DIFF_NO_FAIL,ENABLE_DIFF_NO_FAIL_CONTEXT:()=>ENABLE_DIFF_NO_FAIL_CONTEXT,ENABLE_EMR_SERVICE_POLICY_V2:()=>ENABLE_EMR_SERVICE_POLICY_V2,ENABLE_OPENSEARCH_MULTIAZ_WITH_STANDBY:()=>ENABLE_OPENSEARCH_MULTIAZ_WITH_STANDBY,ENABLE_PARTITION_LITERALS:()=>ENABLE_PARTITION_LITERALS,ENABLE_STACK_NAME_DUPLICATES_CONTEXT:()=>ENABLE_STACK_NAME_DUPLICATES_CONTEXT,EVENTS_TARGET_QUEUE_SAME_ACCOUNT:()=>EVENTS_TARGET_QUEUE_SAME_ACCOUNT,FLAGS:()=>FLAGS,FUTURE_FLAGS:()=>FUTURE_FLAGS,FUTURE_FLAGS_EXPIRED:()=>FUTURE_FLAGS_EXPIRED,IAM_IMPORTED_ROLE_STACK_SAFE_DEFAULT_POLICY_NAME:()=>IAM_IMPORTED_ROLE_STACK_SAFE_DEFAULT_POLICY_NAME,IAM_MINIMIZE_POLICIES:()=>IAM_MINIMIZE_POLICIES,IAM_STANDARDIZED_SERVICE_PRINCIPALS:()=>IAM_STANDARDIZED_SERVICE_PRINCIPALS,INCLUDE_PREFIX_IN_UNIQUE_NAME_GENERATION:()=>INCLUDE_PREFIX_IN_UNIQUE_NAME_GENERATION,KMS_ALIAS_NAME_REF:()=>KMS_ALIAS_NAME_REF,KMS_DEFAULT_KEY_POLICIES:()=>KMS_DEFAULT_KEY_POLICIES,LAMBDA_NODEJS_USE_LATEST_RUNTIME:()=>LAMBDA_NODEJS_USE_LATEST_RUNTIME,LAMBDA_RECOGNIZE_LAYER_VERSION:()=>LAMBDA_RECOGNIZE_LAYER_VERSION,LAMBDA_RECOGNIZE_VERSION_PROPS:()=>LAMBDA_RECOGNIZE_VERSION_PROPS,NEW_PROJECT_CONTEXT:()=>NEW_PROJECT_CONTEXT,NEW_PROJECT_DEFAULT_CONTEXT:()=>NEW_PROJECT_DEFAULT_CONTEXT,NEW_STYLE_STACK_SYNTHESIS_CONTEXT:()=>NEW_STYLE_STACK_SYNTHESIS_CONTEXT,RDS_LOWERCASE_DB_IDENTIFIER:()=>RDS_LOWERCASE_DB_IDENTIFIER,REDSHIFT_COLUMN_ID:()=>REDSHIFT_COLUMN_ID,ROUTE53_PATTERNS_USE_CERTIFICATE:()=>ROUTE53_PATTERNS_USE_CERTIFICATE,S3_CREATE_DEFAULT_LOGGING_POLICY:()=>S3_CREATE_DEFAULT_LOGGING_POLICY,S3_GRANT_WRITE_WITHOUT_ACL:()=>S3_GRANT_WRITE_WITHOUT_ACL,S3_SERVER_ACCESS_LOGS_USE_BUCKET_POLICY:()=>S3_SERVER_ACCESS_LOGS_USE_BUCKET_POLICY,SECRETS_MANAGER_PARSE_OWNED_SECRET_NAME:()=>SECRETS_MANAGER_PARSE_OWNED_SECRET_NAME,SECRETS_MANAGER_TARGET_ATTACHMENT_RESOURCE_POLICY:()=>SECRETS_MANAGER_TARGET_ATTACHMENT_RESOURCE_POLICY,SNS_SUBSCRIPTIONS_SQS_DECRYPTION_POLICY:()=>SNS_SUBSCRIPTIONS_SQS_DECRYPTION_POLICY,STACK_RELATIVE_EXPORTS_CONTEXT:()=>STACK_RELATIVE_EXPORTS_CONTEXT,TARGET_PARTITIONS:()=>TARGET_PARTITIONS,VALIDATE_SNAPSHOT_REMOVAL_POLICY:()=>VALIDATE_SNAPSHOT_REMOVAL_POLICY,futureFlagDefault:()=>futureFlagDefault});function futureFlagDefault(flag){const value=CURRENT_VERSION_FLAG_DEFAULTS[flag]??false;if(typeof value!=="boolean"){throw new Error(`futureFlagDefault: default type of flag '${flag}' should be boolean, got '${typeof value}'`)}return value}var ENABLE_STACK_NAME_DUPLICATES_CONTEXT,ENABLE_DIFF_NO_FAIL_CONTEXT,ENABLE_DIFF_NO_FAIL,NEW_STYLE_STACK_SYNTHESIS_CONTEXT,STACK_RELATIVE_EXPORTS_CONTEXT,DOCKER_IGNORE_SUPPORT,SECRETS_MANAGER_PARSE_OWNED_SECRET_NAME,KMS_DEFAULT_KEY_POLICIES,S3_GRANT_WRITE_WITHOUT_ACL,ECS_REMOVE_DEFAULT_DESIRED_COUNT,RDS_LOWERCASE_DB_IDENTIFIER,APIGATEWAY_USAGEPLANKEY_ORDERINSENSITIVE_ID,EFS_DEFAULT_ENCRYPTION_AT_REST,LAMBDA_RECOGNIZE_VERSION_PROPS,LAMBDA_RECOGNIZE_LAYER_VERSION,CLOUDFRONT_DEFAULT_SECURITY_POLICY_TLS_V1_2_2021,CHECK_SECRET_USAGE,TARGET_PARTITIONS,ECS_SERVICE_EXTENSIONS_ENABLE_DEFAULT_LOG_DRIVER,EC2_UNIQUE_IMDSV2_LAUNCH_TEMPLATE_NAME,ECS_ARN_FORMAT_INCLUDES_CLUSTER_NAME,IAM_MINIMIZE_POLICIES,IAM_IMPORTED_ROLE_STACK_SAFE_DEFAULT_POLICY_NAME,VALIDATE_SNAPSHOT_REMOVAL_POLICY,CODEPIPELINE_CROSS_ACCOUNT_KEY_ALIAS_STACK_SAFE_RESOURCE_NAME,S3_CREATE_DEFAULT_LOGGING_POLICY,SNS_SUBSCRIPTIONS_SQS_DECRYPTION_POLICY,APIGATEWAY_DISABLE_CLOUDWATCH_ROLE,ENABLE_PARTITION_LITERALS,EVENTS_TARGET_QUEUE_SAME_ACCOUNT,IAM_STANDARDIZED_SERVICE_PRINCIPALS,ECS_DISABLE_EXPLICIT_DEPLOYMENT_CONTROLLER_FOR_CIRCUIT_BREAKER,S3_SERVER_ACCESS_LOGS_USE_BUCKET_POLICY,ROUTE53_PATTERNS_USE_CERTIFICATE,AWS_CUSTOM_RESOURCE_LATEST_SDK_DEFAULT,DATABASE_PROXY_UNIQUE_RESOURCE_NAME,CODEDEPLOY_REMOVE_ALARMS_FROM_DEPLOYMENT_GROUP,APIGATEWAY_AUTHORIZER_CHANGE_DEPLOYMENT_LOGICAL_ID,EC2_LAUNCH_TEMPLATE_DEFAULT_USER_DATA,SECRETS_MANAGER_TARGET_ATTACHMENT_RESOURCE_POLICY,REDSHIFT_COLUMN_ID,ENABLE_EMR_SERVICE_POLICY_V2,EC2_RESTRICT_DEFAULT_SECURITY_GROUP,APIGATEWAY_REQUEST_VALIDATOR_UNIQUE_ID,INCLUDE_PREFIX_IN_UNIQUE_NAME_GENERATION,KMS_ALIAS_NAME_REF,EFS_DENY_ANONYMOUS_ACCESS,EFS_MOUNTTARGET_ORDERINSENSITIVE_LOGICAL_ID,AUTOSCALING_GENERATE_LAUNCH_TEMPLATE,ENABLE_OPENSEARCH_MULTIAZ_WITH_STANDBY,LAMBDA_NODEJS_USE_LATEST_RUNTIME,FLAGS,CURRENT_MV,CURRENT_VERSION_EXPIRED_FLAGS,NEW_PROJECT_CONTEXT,CURRENT_VERSION_FLAG_DEFAULTS,FUTURE_FLAGS_EXPIRED,FUTURE_FLAGS,NEW_PROJECT_DEFAULT_CONTEXT;var init_features=__esm({"../@aws-cdk/cx-api/lib/features.ts"(){"use strict";init_flag_modeling();ENABLE_STACK_NAME_DUPLICATES_CONTEXT="@aws-cdk/core:enableStackNameDuplicates";ENABLE_DIFF_NO_FAIL_CONTEXT="aws-cdk:enableDiffNoFail";ENABLE_DIFF_NO_FAIL=ENABLE_DIFF_NO_FAIL_CONTEXT;NEW_STYLE_STACK_SYNTHESIS_CONTEXT="@aws-cdk/core:newStyleStackSynthesis";STACK_RELATIVE_EXPORTS_CONTEXT="@aws-cdk/core:stackRelativeExports";DOCKER_IGNORE_SUPPORT="@aws-cdk/aws-ecr-assets:dockerIgnoreSupport";SECRETS_MANAGER_PARSE_OWNED_SECRET_NAME="@aws-cdk/aws-secretsmanager:parseOwnedSecretName";KMS_DEFAULT_KEY_POLICIES="@aws-cdk/aws-kms:defaultKeyPolicies";S3_GRANT_WRITE_WITHOUT_ACL="@aws-cdk/aws-s3:grantWriteWithoutAcl";ECS_REMOVE_DEFAULT_DESIRED_COUNT="@aws-cdk/aws-ecs-patterns:removeDefaultDesiredCount";RDS_LOWERCASE_DB_IDENTIFIER="@aws-cdk/aws-rds:lowercaseDbIdentifier";APIGATEWAY_USAGEPLANKEY_ORDERINSENSITIVE_ID="@aws-cdk/aws-apigateway:usagePlanKeyOrderInsensitiveId";EFS_DEFAULT_ENCRYPTION_AT_REST="@aws-cdk/aws-efs:defaultEncryptionAtRest";LAMBDA_RECOGNIZE_VERSION_PROPS="@aws-cdk/aws-lambda:recognizeVersionProps";LAMBDA_RECOGNIZE_LAYER_VERSION="@aws-cdk/aws-lambda:recognizeLayerVersion";CLOUDFRONT_DEFAULT_SECURITY_POLICY_TLS_V1_2_2021="@aws-cdk/aws-cloudfront:defaultSecurityPolicyTLSv1.2_2021";CHECK_SECRET_USAGE="@aws-cdk/core:checkSecretUsage";TARGET_PARTITIONS="@aws-cdk/core:target-partitions";ECS_SERVICE_EXTENSIONS_ENABLE_DEFAULT_LOG_DRIVER="@aws-cdk-containers/ecs-service-extensions:enableDefaultLogDriver";EC2_UNIQUE_IMDSV2_LAUNCH_TEMPLATE_NAME="@aws-cdk/aws-ec2:uniqueImdsv2TemplateName";ECS_ARN_FORMAT_INCLUDES_CLUSTER_NAME="@aws-cdk/aws-ecs:arnFormatIncludesClusterName";IAM_MINIMIZE_POLICIES="@aws-cdk/aws-iam:minimizePolicies";IAM_IMPORTED_ROLE_STACK_SAFE_DEFAULT_POLICY_NAME="@aws-cdk/aws-iam:importedRoleStackSafeDefaultPolicyName";VALIDATE_SNAPSHOT_REMOVAL_POLICY="@aws-cdk/core:validateSnapshotRemovalPolicy";CODEPIPELINE_CROSS_ACCOUNT_KEY_ALIAS_STACK_SAFE_RESOURCE_NAME="@aws-cdk/aws-codepipeline:crossAccountKeyAliasStackSafeResourceName";S3_CREATE_DEFAULT_LOGGING_POLICY="@aws-cdk/aws-s3:createDefaultLoggingPolicy";SNS_SUBSCRIPTIONS_SQS_DECRYPTION_POLICY="@aws-cdk/aws-sns-subscriptions:restrictSqsDescryption";APIGATEWAY_DISABLE_CLOUDWATCH_ROLE="@aws-cdk/aws-apigateway:disableCloudWatchRole";ENABLE_PARTITION_LITERALS="@aws-cdk/core:enablePartitionLiterals";EVENTS_TARGET_QUEUE_SAME_ACCOUNT="@aws-cdk/aws-events:eventsTargetQueueSameAccount";IAM_STANDARDIZED_SERVICE_PRINCIPALS="@aws-cdk/aws-iam:standardizedServicePrincipals";ECS_DISABLE_EXPLICIT_DEPLOYMENT_CONTROLLER_FOR_CIRCUIT_BREAKER="@aws-cdk/aws-ecs:disableExplicitDeploymentControllerForCircuitBreaker";S3_SERVER_ACCESS_LOGS_USE_BUCKET_POLICY="@aws-cdk/aws-s3:serverAccessLogsUseBucketPolicy";ROUTE53_PATTERNS_USE_CERTIFICATE="@aws-cdk/aws-route53-patters:useCertificate";AWS_CUSTOM_RESOURCE_LATEST_SDK_DEFAULT="@aws-cdk/customresources:installLatestAwsSdkDefault";DATABASE_PROXY_UNIQUE_RESOURCE_NAME="@aws-cdk/aws-rds:databaseProxyUniqueResourceName";CODEDEPLOY_REMOVE_ALARMS_FROM_DEPLOYMENT_GROUP="@aws-cdk/aws-codedeploy:removeAlarmsFromDeploymentGroup";APIGATEWAY_AUTHORIZER_CHANGE_DEPLOYMENT_LOGICAL_ID="@aws-cdk/aws-apigateway:authorizerChangeDeploymentLogicalId";EC2_LAUNCH_TEMPLATE_DEFAULT_USER_DATA="@aws-cdk/aws-ec2:launchTemplateDefaultUserData";SECRETS_MANAGER_TARGET_ATTACHMENT_RESOURCE_POLICY="@aws-cdk/aws-secretsmanager:useAttachedSecretResourcePolicyForSecretTargetAttachments";REDSHIFT_COLUMN_ID="@aws-cdk/aws-redshift:columnId";ENABLE_EMR_SERVICE_POLICY_V2="@aws-cdk/aws-stepfunctions-tasks:enableEmrServicePolicyV2";EC2_RESTRICT_DEFAULT_SECURITY_GROUP="@aws-cdk/aws-ec2:restrictDefaultSecurityGroup";APIGATEWAY_REQUEST_VALIDATOR_UNIQUE_ID="@aws-cdk/aws-apigateway:requestValidatorUniqueId";INCLUDE_PREFIX_IN_UNIQUE_NAME_GENERATION="@aws-cdk/core:includePrefixInUniqueNameGeneration";KMS_ALIAS_NAME_REF="@aws-cdk/aws-kms:aliasNameRef";EFS_DENY_ANONYMOUS_ACCESS="@aws-cdk/aws-efs:denyAnonymousAccess";EFS_MOUNTTARGET_ORDERINSENSITIVE_LOGICAL_ID="@aws-cdk/aws-efs:mountTargetOrderInsensitiveLogicalId";AUTOSCALING_GENERATE_LAUNCH_TEMPLATE="@aws-cdk/aws-autoscaling:generateLaunchTemplateInsteadOfLaunchConfig";ENABLE_OPENSEARCH_MULTIAZ_WITH_STANDBY="@aws-cdk/aws-opensearchservice:enableOpensearchMultiAzWithStandby";LAMBDA_NODEJS_USE_LATEST_RUNTIME="@aws-cdk/aws-lambda-nodejs:useLatestRuntimeVersion";FLAGS={[ENABLE_STACK_NAME_DUPLICATES_CONTEXT]:{type:0,summary:"Allow multiple stacks with the same name",detailsMd:`
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

SyntaxError: Unexpected token '?'
    at wrapSafe (internal/modules/cjs/loader.js:915:16)
    at Module._compile (internal/modules/cjs/loader.js:963:27)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:1027:10)
    at Module.load (internal/modules/cjs/loader.js:863:32)
    at Function.Module._load (internal/modules/cjs/loader.js:708:14)
    at Module.require (internal/modules/cjs/loader.js:887:19)
    at require (internal/modules/cjs/helpers.js:74:18)
    at Object.<anonymous> (/usr/local/lib/node_modules/aws-cdk/bin/cdk.js:3:15)
    at Module._compile (internal/modules/cjs/loader.js:999:30)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:1027:10)
